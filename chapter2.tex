% !TeX root = main.tex

\chapter{线性算子与线性泛函}

\section{连续线性映射}

	\begin{Definition}\index{X!线性算子}
		设$ E, F $是$ \K $上的线性空间, 若映射$ u : E\to F $满足
		\[
			\forall \lambda\in\K\,\forall x,y\in E\,(u(\lambda x+y)=\lambda u(x)+u(y)),
		\]
		则称$ u : E\to F $是一个\textbf{线性映射}或\textbf{线性算子}, 并记$ \CL(E,F) $是$ E $到$ F $线性算子的全体.
	\end{Definition}
	
	特别地, 当$ E=F $时, 用$ \CL(E) $记$ \mathcal{L}(E,E) $.
	
	\begin{Example}~
	\begin{enumerate}[(1)]
		\item $ \forall \lambda\in\K $, 定义
		\[
			M_\lambda : E\to E,\qquad x\mapsto\lambda x,
		\]
		则$ M_\lambda\in\CL(E) $. 而对$ y\in E $, 定义
		\[
			T_y : E\to E,\qquad x\mapsto x+y,
		\]
		则$ T_y\notin\CL(E) $.
		
		\item 设$ E=C[0,1] $, 对$ f\in C[0,1] $, 定义$ M_fg=fg $, 则$ M_f $是线性算子. 再取$ x\in[0,1] $, 定义$ \delta_x(f)=f(x) $, 则$ \delta_x $是线性算子, 再定义
		\[
			I(f)(x)=\int_0^xf(t)\diff t,
		\]
	则$ I $也是线性算子.
	\end{enumerate}
	\end{Example}
	
	\begin{Remark}
		关于$ \CL(E,F) $的一些注记:
	\begin{enumerate}[(1)]
	\item $ \CL(E,F) $本身也是一个线性空间, 其上的线性运算可以定义为
	\[
		\begin{aligned}
			\lambda u : E\to F,& \quad x\mapsto\lambda u(x),\\
			u+v : E\to F,& \quad x\mapsto u(x)+v(x),
		\end{aligned}
	\]
	其中$ \lambda\in\K $, $ u, v\in\CL(E,F) $.
	
	\item 对$ u\in\CL(E,F) $, 定义其\textbf{核空间}\index{H!核空间}为
	\[
	\ker u=\{ x\in E : u(x)=0 \}.
	\]
	则$ \ker u $是$ E $的线性子空间, 且$ u $是单射当且仅当$ \ker u=\{0\} $.
	\end{enumerate}
	\end{Remark}
	
	\begin{Theorem}[连续性]\label{thm:线性算子连续性}
	设$ E, F $是$ \K $上的两个赋范空间, 且$ u\in\CL(E,F) $, 则下列命题等价:
	\begin{enumerate}[(1)]
	\item $ u $在$ E $上连续;
	\item $ u $在$ E $上的某一点连续;
	\item $ u $在原点连续;
	\item $ \exists C\geqslant 0\,\forall x\in E\,(\norm{u(x)}\leqslant C\norm{x}) $.
	\end{enumerate}
	\end{Theorem}
	\begin{Proof}
		(1) $ \Rightarrow $ (2) : 显然.
		
		(2) $ \Rightarrow $ (3) : 设$ u $在$ x_0\in E $连续, 那么
		\[
			\forall\varepsilon>0\,\exists r>0\,(x\in B(x_0,r)\Rightarrow\norm{u(x)-u(x_0)}<\varepsilon),
		\]
		则对$ \forall y\in B(0,r) $, 有
		\[
			\norm{u(y)-u(0)}=\norm{u(y)}=\norm{u(x_0+y)-u(x_0)}<\varepsilon,
		\]
		即$ u $在原点连续.
		
		(3) $ \Rightarrow $ (4) : 由$ u $在原点连续可知
		\[
			\exists r_0>0\,(y\in\overline{B(0,r)}\Rightarrow\norm{u(y)}<1).
		\]
		则$ \forall x\in E $, 由
		\[
			\norm{u(x)}=\norm{u\left(\dfrac{xr}{\norm{x}}\right)}\frac{\norm{x}}{r}<\frac{\norm{x}}{r},
		\]
		取$ C=\frac{1}{r} $即可.
		
		(4) $ \Rightarrow $ (1) : 由$ u\in\mathcal{L}(E,F) $, 有
		\[
			\forall x,y\in E\,(\norm{u(x)-u(y)}\leqslant C\norm{x-y}),
		\]
		即$ u $是Lipschitz的, 从而$ u $在$ E $连续.\qed
	\end{Proof}
	
	\begin{Remark}
		上述定理表明在赋范空间上, 连续线性映射都是Lipschitz的, 从而连续线性映射一定一致连续.
	\end{Remark}
	
	\begin{Definition}[算子范数]\index{Y!有界线性算子}
		设$ E,F $都是赋范空间, $ u\in\mathcal{L}(E,F) $. 若
		\[
			\exists C\geqslant 0\,\forall x\in E\,(\norm{u(x)}\leqslant C\norm{x}),
		\]
		则称$ u $是\textbf{有界}的. 再令
		\[
			\norm{u}=\sup_{\norm{x}\ne 0}\frac{\norm{u(x)}}{\norm{x}}
		\]
		称$ \norm{u} $是算子$ u $的\textbf{范数}. 并记$ \CB(E,F) $是$ E $到$ F $的有界线性算子的全体, 且类似地记$ \mathcal{B}(E)=\mathcal{B}(E,E) $.
	\end{Definition}
	
	\begin{Example}
		设$ E=\C^n $, 则$ \mathcal{L}(E)=\mathbb{M}_n(\C)=\mathcal{B}(E) $, 其中$ \mathbb{M}_n(\C) $是$ n $阶复矩阵的全体. 对$ A\in\mathbb{M}_n(\C) $, 定义
		\[
			\norm{A}=\sup_{\norm{x}\ne 0}\frac{\norm{Ax}}{\norm{x}}
		\]
		为$ A $的范数. 则由
		\[
			\norm{A}^2=\sup_{\norm{x}\ne 0}\frac{\norm{Ax}^2}{\norm{x}^2}=\sup_{\norm{x}\ne 0}\frac{\lrangle{Ax,Ax}}{\norm{x}^2}=\sup_{\norm{x}\ne 0}\frac{\lrangle{A^\dagger Ax,x}}{\norm{x}^2}=\sup\{\abs{\lambda}\},
		\]
		可知$ A $是有界线性算子. 其中$ \lambda $是$ A^\dagger A $的特征值.
	\end{Example}
	
	\begin{Remark}~
	\begin{enumerate}[(1)]\label{rmk:范数性质}
		\item $ \CB(E,F) $是$ \CL(E,F) $的线性子空间, 这由
		\[
			\norm{\lambda u}=\abs{\lambda}\norm{u},\qquad \norm{u+v}\leqslant\norm{u}+\norm{v}
		\]
		可知. 且$ (\mathcal{B}(E,F),\norm{\cdot}) $还是一个赋范空间. 由定理\ref{thm:线性算子连续性}可知$ u $连续等价于$ u $有界.
		
		\item $ u $的有界性实际上指$ \norm{u(x)} $在$ E $的有界集上有界. 实际上除非$ u\equiv 0 $, 否则$ \norm{u(x)} $不可能在全空间上有界.
		
		\item\label{rmk:范数性质最小C} 范数$ \norm{u} $也可以等价地定义为
		\[
			\norm{u}:=\sup_{\norm{x}\ne 0}\frac{\norm{u(x)}}{\norm{x}}=\sup_{\norm{x}\leqslant 1}\norm{u(x)}=\sup_{\norm{x}=1}\norm{u(x)},
		\]
		且$ \norm{u} $就是定义中满足条件的$ C $中最小的.
	\end{enumerate}
	\end{Remark}

	\begin{Theorem}
		 设 $ E $ 是赋范空间,  $ F $ 是Banach空间, 则 $ \CB(E, F) $ 是Banach空间.
	\end{Theorem}
	\begin{Proof}
		取 $ (u_{n})_{n\geqslant1} $ 是 $ \CB(E, F) $ 上的 Cauchy列, 即 
		\[
			\forall\varepsilon>0\,\exists n_{0}\in\N\,(n, m\geqslant n_{0}\Rightarrow \norm{u_{m}-u_{n}}<\varepsilon)
		\]
		而 $ \forall x\in E $, 由
		\[
			\norm{u_{m}(x)-u_{n}(x)}=\norm{(u_{m}-u_{n})(x)}\leqslant\norm{u_{m}-u_{n}}\cdot\norm{x}
		\]
		可知 $ (u_{n}(x))_{n\geqslant1} $ 是 $ F $ 中的 Cauchy列, 因 $ F $ 是Banach空间, $ \lim\limits_{n\to \infty} u_{n}(x) $ 存在, 记作 $ u(x) $, 从而定义了算子 $ u $, 下证 $ u\in\CB(E, F) $. 由 
		\[
			\begin{aligned}
				u(\lambda x) & =\lim_{n\to\infty}u_{n}(\lambda x)\\
				& =\lambda\lim_{n\to\infty}u_{n}(x)=\lambda u(x)
			\end{aligned}\qquad
			\text{与}\qquad
			\begin{aligned}
				u(x+y) & =\lim_{n\to\infty}u_{n}(x+y)\\
				& =\lim_{n\to\infty}u_{n}(x)+u_{n}(y)=u(x)+u(y)
			\end{aligned}
		\]
		可知线性性成立, 再由
		\[
			\begin{aligned}
				\norm{u} & =\sup_{\norm{x}=1}\norm{u(x)}=\sup_{\norm{x}=1}\norm{u(x)-u_{n}(x)+u_{n}(x)}\\
				 & \leqslant \sup_{\norm{x}=1}\norm{u(x)-u_{n}(x)}+\sup_{\norm{x}=1}\norm{u_{n}(x)}\\
				& \leqslant \sup_{\norm{x}=1}\limsup_{m\to\infty}\norm{u_{m}-u_{n}}\cdot\norm{x}+\norm{u_{n}}<\infty
			\end{aligned}
		\]
		可知有界性成立. (因为 $ (u_{n})_{n\geqslant1} $ 是 Cauchy列, 从而 $ \limsup\limits_{m\to\infty}\norm{u_{m}-u_{n}}<\infty $)

		还需说明 $ \lim\limits_{n\to\infty}u_{n}=u $. 这由
		\[
			\begin{aligned}
				\norm{u-u_{n}} & =\sup_{\norm{x}=1}\norm{u(x)-u_{n}(x)}\leqslant \sup_{\norm{x}=1}\limsup_{m\to\infty
				}\norm{u_{m}-u_{n}}\norm{x}\\
				& =\limsup_{m\to\infty}\norm{u_{m}-u_{n}}\to 0\,(n\to\infty)
			\end{aligned}
		\]
		可知. 从而 $ \CB(E, F) $ 完备, 即为 Banach空间.\qed
	\end{Proof}

	\begin{Definition}[线性泛函]\label{def:线性泛函}
		 设 $ (E, \norm{\cdot}) $ 是数域 \K 上的赋范空间,  $ \CB(E, \K) $ 是 $ E $ 的\textbf{对偶}, 记作 $ E^{*} $, 则 $ E^{*} $ 是Banach空间, 并称 $ E^{*} $ 中的元素为 $ E $ 的\textbf{连续线性泛函}\index{L!连续线性泛函}.
	\end{Definition}
	\begin{Example}
		给出几个线性泛函相关的例子:
		\begin{enumerate}[(1)]
			\item  对 $ f\in C[0, 1] $, $ x\in [0, 1] $, 定义 $ \delta_{x}(f)=f(x) $, 则 $ \delta_{x} $ 是连续线性泛函; 再对 $ g\in C[0, 1] $ 定义 $ \rho_{g}(f)=\int_{0}^{1}fg\diff x $, 则 $ \rho_{g} $ 是连续线性泛函.
			\item 在 $ \C^{n} $ 上给定 $ y\in\C^{n} $ 定义 
			 \[
				\rho_{y}(x)=\lrangle{x, y}=\sum_{i=1}^{n}x_{i}\baro{y}_{i}.
			\]
			由 Cauchy不等式可知 $ \rho_{y} $ 是连续线性泛函.
			\item $ \forall x, y\in \C^{n} $, 定义 $ \mathbb{M}_{n}(\C) $ 上的算子
			\[
				\omega_{x, y}(A)=\lrangle{Ax, y}.
			\]
			则由
			\[
				\abs{\omega_{x, y}(A)}=\abs{\lrangle{Ax, y}}\leqslant\norm{Ax}\norm{y}\leqslant\norm{A}\norm{x}\norm{y}
			\]
			知 $ \norm{\omega_{x, y}}\leqslant\norm{x}\norm{y}<\infty $, 从而 $ \omega_{x, y} $ 也是连续线性泛函.
			\item 对 $ x\in\C^{n} $ 和 $ A\in\mathbb{M}_{n}(\C) $, 定义 $ x\mapsto \norm{Ax} $, 则它不是连续线性泛函, 甚至不满足线性性.
		\end{enumerate}
	\end{Example}

	\begin{Theorem}
		 设 $ E $ 是有限维线性空间,  $ F $ 是任一赋范空间, 则 $ \mathcal{L}(E, F)=\CB(E, F) $.  
	\end{Theorem}
	\begin{Proof}
		设 $ u\in\CL(E, F) $, 取 $ E $ 的中的一组基 $ e_{1}, e_{2}, \dots e_{n} $, 则
		\[
			\forall x\in E\,\exists[x_{1}, x_{2}, \dots, x_{n}]^{\mathrm T}\,\left(x=\sum_{i=1}^{n}x_{i}e_{i}\right)
		\]
		因为 $ E $ 是有限维的, 故 $ E $ 中任意范数等价, 即 $ \norm{\cdot} $ 是 $ E $ 中的一个范数, 有
		\[
			\begin{aligned}
				\norm{u(x)}=\norm{\sum_{i=1}^{n}x_{i}u(e_{i})} & \leqslant \sum_{i=1}^{n}\abs{x_{i}}\norm{u(e_{i})}\\
				& \leqslant\norm{x}_{\infty}\sum_{i=1}^{n}\norm{u(e_{i})}\leqslant\left( c\sum_{i=1}^{n}\norm{u(e_{i})} \right)\norm{x}.
			\end{aligned}
		\]
		从而 $ u $ 有界, 即 $ \CL(E, F)\subset\CB(E, F) $, 从而 $ \CL(E, F)=\CB(E, F) $. \qed
	\end{Proof}
	
	\begin{Theorem}
		 设 $ E $, $ F $, $ G $都是赋范空间,  $ u\in\CB(E, F) $, $ v\in\CB(F, G) $, 则 $ v\circ u\in\CB(E, G) $, 且有 $ \norm{v\circ u}\leqslant\norm{v}\norm{u} $.
	\end{Theorem}
	\begin{Proof}
		因为
		\[
			\norm{v\circ u}=\sup_{\norm{x}=1}\norm{v(u(x))}\leqslant\norm{v}\sup_{\norm{x}=1}\norm{u(x)}\leqslant\norm{v}\norm{u}<\infty.
		\]
		定理结论可得.\qed
	\end{Proof}

	\begin{Remark}
		在不致混淆时, 有时也将 $ v\circ u $ 记作 $ vu $, 并将复合看作乘法, 因为 $ \CB(E) $ 上有自然的加法与数乘, 赋予乘法后 $ \CB(E) $ 成为一个代数.
	\end{Remark}

	\begin{Theorem}
		设 $ E $, $ F $ 是Banach空间,  $ G $ 是 $ E $ 的稠子空间, 则有界线性映射 $ u: G\to F $ 可以唯一地扩张成有界线性映射 $ \tilde{u}:E\to F $, 且 $ \norm{\tilde{u}}=\norm{u} $.
   \end{Theorem}
   \begin{Proof}
		因为 $ G $ 在 $ E $ 中稠密, 则
		\[
			\forall x\in E\,\exists(x_{n})_{n\geqslant1}\subset G\,(\lim_{n\to\infty}x_{n}=x),
		\]
		且 $ (u(x_{n}))_{n\geqslant1} $ 是 Cauchy列, 由 $ F $ 是Banach空间可知 $ (u(x_{n}))_{n\geqslant1} $ 收敛, 不妨记作 $ y $. 定义
		\[
			\tilde{u}: E\to F\quad x\mapsto y=\lim_{n\to\infty}u(x_{n}).
		\]
		由一致连续映射扩张定理可知 $ \tilde{u} $ well-defined.

		易证 $ \tilde{u} $ 是线性的, 且 $ \tilde{u}|_{G}=u $. 而
		\[
			\norm{\tilde{u}(x)}=\lim_{n\to\infty}\norm{u(x_{n})}\leqslant\norm{u}\lim_{n\to\infty}\norm{x_{n}}\leqslant\norm{u}\norm{x},
		\]
		故 $ \norm{\tilde{u}}\leqslant\norm{u} $, 再由 $ \tilde{u}|_{G}=u $ 知 $ \tilde{u}=\norm{u} $.\qed
		
	\end{Proof}

	\begin{Definition}[同构]\label{def:同构}
		 设 $ E $, $ F $ 是赋范空间, 若 $ u\in\CB(E, F) $ 是双射, 且 $ u^{-1} $ 连续, 则 $ u $ 是 $ E\to F $ 的\textbf{同构映射}. 若 $ E $, $ F $ 间存在同构映射, 则称 $ E $ 与 $ F $ \textbf{同构}.\index{T!同构}
	\end{Definition}

	\begin{Remark}
		设范数 $ \norm{\cdot}_{1} $ 与 $ \norm{\cdot}_{2} $ 等价, 则 $ \id_{E} $是同构映射. 在空间 $ \C^{n} $ 上, 相似变换 $ T $ 是同构映射, 且 $ \norm{T} $ 可以充分大. 一个例子是取
		\[
			T_{t}=\begin{bmatrix}
				1 & t\\
				0 & 1
			\end{bmatrix}
			\qquad
			T_{t}^{-1}=\begin{bmatrix}
				1 & -t \\
				0 & 1
			\end{bmatrix},
		\]
		则有 $ \norm{T_{t}}\geqslant1+\abs{t}/2 $, 且 $ \norm{T_{t}^{-1}}\geqslant 1+\abs{t}/2 $.  
	\end{Remark}

	\begin{Theorem}
		 设 $ E $ 是Banach空间,  $ u\in\CB(E) $ 且 $ \norm{u}<1 $, 则存在 $ v\in\CB(E) $ 使
		 \[
			 (\id_{E}-u)v=v(\id_{E}-u)=\id_{E},
		 \]
		 即 $ \id_{E}-u $ 是一个同构映射, 也即 $ \id_{E}-u $ 在 $ \CB(E) $ 可逆.
	\end{Theorem}
	\begin{Proof}
		由 $ \norm{u}<1 $ 可知 $ \sum\limits_{n\geqslant0}u^n $ 绝对收敛, 由 $ E $ 完备可知 $ \CB
		(E) $ 完备, 则 $ \exists v\in\CB(E) $ 使得 $ v=\sum\limits_{n\geqslant 0}u^n $, 则
		\[
			(\id_E-u)v=(\id_E-u)\sum_{n\geqslant 0}u^n=\lim_{n\to\infty}(\id_E-u^{n+1})=\id_E.
		\]
		同理可证 $ v(\id_E-u)=\id_E $, 则 $ v=(\id_E-u)^{-1} $.\qed
	\end{Proof}
	
	\begin{Theorem}
		设 $ E $是赋范空间, $ F\subset E $ 是闭线性子空间. 则
		\[
			\norm{x+F}_0:=\inf\{ \norm{x+y} : y\in F \}
		\]
		是商空间 $ E/F $ 上的一个范数. 在这一范数下 $ u : x\mapsto x+F $是连续的, 且 $ \norm{u}<1 $. 若 $ E $ 是Banach空间, 则 $ E/F $ 是Banach空间.
	\end{Theorem}
	\begin{Proof}
		先说明 $ \norm{\cdot}_{0} $ well-defined. 取 $ x' $ 是 $ x+F $ 的另一代表元, 往证 $ \norm{x'+F}_{0}=\norm{x+F}_{0} $. 因为
		\[
			\begin{aligned}
				\norm{x'+F}_{0} & =\inf\{ \norm{x'+y}:y\in F \}  = \inf\{ \norm{x+x'-x+y}: y\in F \} \\
				 & =\inf\{ \norm{x+y}: y\in F \}=\norm{x+F}_{0}
			\end{aligned}
		\]
		其中第三个等号是因为 $ x'-x+y\in F $. 则 $ \norm{\cdot}_{0} $ well-defined. 再证 $ \norm{\cdot}_{0} $ 是一个范数. 由
		\[
			\begin{aligned}
				\norm{x+F}_{0}=0 & \Longleftrightarrow d(x, F)=0\\
				&  \Longleftrightarrow x\in F\\
				& \Longleftrightarrow x+F=F
			\end{aligned}
		\]
		知正定性成立. 再由
		\[
			\begin{aligned}
				\norm{\lambda x+F}_{0} & =\inf\{ \norm{\lambda x+y}: y\in F \}=\abs{\lambda}\inf\left\{ \norm{x+\frac{y}{\lambda}}: y\in F \right\}\\
				& =\abs{\lambda}\inf\{ \norm{x+y}: y\in F \}=\abs{\lambda}\norm{x+F}_{0}
			\end{aligned}
		\]
		知齐次性成立, 这里 $ \lambda\neq0 $. 下面证明三角不等式 $ \forall\varepsilon>0 $, 对 $ x_{1}, x_{2} $, 有
		\[
			\exists y_{i}\in F : \norm{x_{i}+y_{i}}\leqslant\norm{x_{i}+F}_{0}+\varepsilon, \qquad i=1, 2
		\]
		则
		\[
			\begin{aligned}
				\norm{x_{1}+x_{2}+F}_{0} & =\inf\{ \norm{x_{1}+x_{2}+y}: y=F \}\\
				& =\inf\{ \norm{x_{1}+y_{1}+x_{2}+y_{2}}: y_{1}, y_{2}\in F \}\\
				& \leqslant \norm{x_{1}+F}_{0}+\norm{x_{2}+F}_{0}+2\varepsilon,
			\end{aligned}
		\]
		令 $ \varepsilon\to 0 $ 即得. 从而 $ \norm{\cdot} $ 是 $ E/F $ 上的范数. 且由
		\[
			 \norm{u(x)}=\norm{x+F}_{0}\leqslant \norm{x+0}=\norm{0}
		\]
		知 $ \norm{u}<1 $.

		若 $ E $ 是Banach空间. 取 $ E/F $ 中绝对收敛的级数 $ \sum\limits_{n\geqslant1}(x_{n}+F) $, 则
		\[
			\exists y_{n}\in F\,(\norm{x_{n}+y_{n}}\leqslant 2^{-n}+\norm{x_{n}+F}_{0})
		\]
		从而由 $ \sum\limits_{n\geqslant}\norm{x_{n}+F}_{0} $ 收敛知 $ \sum\limits_{n\geqslant0}\norm{x_{n}+y_{n}} $ 在 $ E $ 中绝对收敛, 则
		\[
			\exists z\in E\,\bigg( \sum_{n\geqslant0}(x_{n}+y_{n})=z \bigg)
		\]
		而 
		\[
			\begin{aligned}
				\norm{z+F-\sum_{k=1}^{n}x_{k}+F}_{0} & =\inf\left\{ \norm{z-\sum_{k=1}^{n}x_{k}+y}:y\in F \right\}\\
				& \leqslant \norm{z-\sum_{k=1}^{n}(x_{k}+y_{n})}\to 0,\qquad n\to\infty
			\end{aligned}
		\]
		即 $ E/F $ 是Banach空间.\qed
	\end{Proof}
	
\section{内积空间}
	
	\begin{Definition}[内积空间]\index{N!内积}\index{N!内积空间}
	设$ H $是$ \K $上的线性空间, 若映射$ \lrangle{\cdot,\cdot} : H\times H\to\K $满足
	\begin{enumerate}[(1)]
	\item 线性性: $ \forall \lambda_1,\lambda_2\in\K,\,\forall x_1,x_2,y\in H,\ \lrangle{\lambda_1x_1+\lambda_2x_2,y}=\lambda_1\lrangle{x_1,y}+\lambda_2\lrangle{x_2,y} $;
	\item 共轭对称性: $ \lrangle{x,y}=\baro{\lrangle{y,x}} $;
	\item 非负性: $ \forall x\in H $, $ \lrangle{x,x}\geqslant 0 $且$ \lrangle{x,x}=0 $当且仅当$ x=0 $,
	\end{enumerate}
	则称$ \lrangle{\cdot,\cdot} $是一个\textbf{内积}, 并称赋予了内积的空间$ H $是\textbf{内积空间}.
	\end{Definition}
	
	\begin{Example}
	一些常见的内积空间, 在不特殊说明的情况下, 以后提到下面的空间时均默认其上定义的内积是本例中定义的内积:
	\begin{enumerate}[(1)]
	\item 在Euclid空间$ \K^n $上赋以内积$ \lrangle{x,y}=\sum\limits_{i=1}^nx_i\bar{y}_i $. 注意到Euclid范数$ \norm{x}=\sqrt{\lrangle{x,x}} $可被该内积诱导.
	\item 在$ L_2(X) $上赋以内积$ \lrangle{f,g}=\int_Xf\bar{g}\diff\mu $, 且由H\"older不等式可知
	\[
	\abs{\lrangle{f,g}}\leqslant\norm{f}_2\norm{g}_2<\infty,
	\]
	但当$ p\ne 2 $时, $ L_p(X) $不是内积空间.
	\item 在连续函数空间$ C([a,b],\K) $上可以定义内积$ \lrangle{f,g}=\int_a^bf\bar{g}\diff x $.
	\item 在$ n $阶方阵空间$ \mathbb{M}_n(\K) $上可以定义内积$ \lrangle{A,B}=\mathrm{tr(B^\dagger A)} $.
	\end{enumerate}
	\end{Example}
	
	\begin{Theorem}[Cauchy-Schwarz]
	设$ H $是一个内积空间, 则$ \forall x,y\in H $, 有
	\[
	\abs{\lrangle{x,y}}^2\leqslant\lrangle{x,x}\lrangle{y,y}.
	\]
	其中上式等号成立当且仅当$ x $与$ y $线性相关.
	\end{Theorem}
	\begin{Proof}
	$ y=0 $的情形是平凡的, 不妨设$ y\ne 0 $. 那么$ \forall x,y\in H,\ \forall\lambda\in\K $, 有
	\[
	0\leqslant\lrangle{x+\lambda y,x+\lambda y}=\lrangle{x,x}+\bar{\lambda}\lrangle{x,y}+\lambda\baro{\lrangle{x,y}}+\lambda\bar{\lambda}\lrangle{y,y}.
	\]
	取$ \lambda=-\frac{\lrangle{x,y}}{\lrangle{y,y}} $代入, 得
	\[
	\lrangle{x,x}-\frac{\abs{\lrangle{x,y}}^2}{\lrangle{y,y}}-\frac{\abs{\lrangle{x,y}}^2}{\lrangle{y,y}}+\frac{\abs{\lrangle{x,y}}^2}{\abs{\lrangle{y,y}}^2}\lrangle{y,y}\geqslant 0,
	\]
	整理可得$ \abs{\lrangle{x,y}}^2\leqslant\lrangle{x,x}\lrangle{y,y} $.
	
	由证明过程可知等号成立当且仅当$ \lrangle{x+\lambda y,x+\lambda y}=0 $, 也即$ x=-\lambda y $, 此时$ x,y $是线性相关的.\qed
	\end{Proof}
	
	\begin{Corollary}\label{col:内积诱导范数}
	设$ H $是内积空间, 则$ \norm{x}=\sqrt{\lrangle{x,x}} $是范数.
	\end{Corollary}
	\begin{Proof}
	由内积的定义可知正定性与齐次性都成立, 只需验证三角不等式成立即可. 由
	\[
		\begin{aligned}
		\norm{x+y}^2=\lrangle{x+y,x+y}&=\lrangle{x,x}+\lrangle{x,y}+\baro{\lrangle{x,y}}+\lrangle{y,y}\\
		&\leqslant\norm{x}^2+2\Re\lrangle{x,y}+\norm{y}^2\leqslant\norm{x}^2+2\norm{x}\norm y+\norm y^2=(\norm x+\norm y)^2.
		\end{aligned}
	\]
	从而$ \norm{x+y}\leqslant\norm x+\norm y $.\qed
	\end{Proof}
	
	\begin{Definition}[Hilbert空间]\index{H!Hilbert空间}
	设$ H $是一个内积空间, 称推论\,\ref{col:内积诱导范数}\,中的范数$ \norm{\cdot} $是由内积$ \lrangle{\cdot,\cdot} $诱导出的范数, 从而$ (H,\norm{\cdot}) $是赋范空间. 若它是一个Banach空间, 则称$ H $是\textbf{Hilbert空间}.
	\end{Definition}
	
	由Cauchy-Schwarz不等式可以导出内积相对于自身诱导的范数是连续的. 同时, 类似于赋范空间的结论, 内积空间$ H $的完备化$ \tilde{H} $是Hilbert空间.
	
	\begin{Example}
	$ L_2(X) $是Hilbert空间, $ \mathbb{M}_n(\K) $也是Hilbert空间. 但$ C[0,1] $是内积空间而不是Hilbert空间, 其完备化是$ L_2[0,1] $.
	\end{Example}
	
	\begin{Proposition}[极化恒等式]
	设$ H $是$ \K $上的内积空间, 则对$ \forall x,y\in H $, 有
	\[
	\lrangle{x,y}=\frac{1}{4}\sum_{k=0}^3\imag^k\norm{x+\imag^ky}^2.
	\]
	特别地, 在实的情形时上式退化为
	\[
	\lrangle{x,y}=\frac{1}{2}(\norm{x+y}^2-\norm{x}^2-\norm{y}^2).
	\]
	\end{Proposition}
	
	\begin{Proposition}[平行四边形公式]
	设$ H $是$ \K $上的内积空间, 则对$ \forall x,y\in H $, 有
	\[
	\norm{x+y}^2+\norm{x-y}^2=2(\norm{x}^2+\norm{y}^2).
	\]
	\end{Proposition}
	
	上面的两个命题, 即极化恒等式和平行四边形公式, 都可以将范数展开成内积之后直接证明.
	
	\begin{Corollary}
	对$ \forall f,g\in L_2(X) $, 有
	\[
	\norm{f+g}_2^2+\norm{f-g}_2^2=2(\norm{f}_2^2+\norm g_2^2).
	\]
	进一步, 对$ 2\leqslant p<\infty $, 有
	\[
	\norm{f+g}_p^p+\norm{f-g}_p^p\leqslant 2^{p-1}(\norm{f}_p^p+\norm{g}_p^p),
	\]
	上式称为\textbf{Clarkson不等式}, 其证明在正文中不再叙述.
	\end{Corollary}
	
	\begin{Theorem}
	设$ H $是赋范空间, 若范数$ \norm{\cdot} $满足平行四边形公式, 则它可被$ H $上的一个内积诱导出来.
	\end{Theorem}

	\begin{Proof}
		构造二元映射:
		\[
			\lrangle{\cdot, \cdot}: H\times H\to \C, \qquad(x, y)\mapsto\frac{1}{4}\sum_{k=0}^3\imag^k\norm{x+\imag^ky}^2,
		\]
		注意到
		\[
			\lrangle{x, x}=\frac{1}{4}(4\norm{x}^{2}+2\imag\norm{x}^{2}-2\imag\norm{x}^{2})=\norm{x}^{2}\geqslant0,
		\]
		且上式取等当且仅当 $ \norm{x}^{2}=0 $, 即 $ x=0 $, 从而正定性与非负性成立, 再由
		\[
			\begin{aligned}
				\lrangle{y, x} & =\frac{1}{4}(\norm{x+y}^{2}-\norm{x-y}^{2}+\imag\norm{x-\imag y}^{2}-\imag\norm{x+\imag y}^{2})\\
				& = \frac{1}{4}\baro{(\norm{x+y}^{2}-\norm{x-y}^{2}-\imag\norm{x-\imag y}^{2}+\imag\norm{x+\imag y}^{2})} =\baro{\lrangle{x, y}}
			\end{aligned}
		\]
		可知共轭对称性成立, 只需证明线性性.

		为此, 我们先证明 $ \lrangle{2x, y}=2\lrangle{x, y} $, 由平行四边形公式, 有
		\begin{equation}\tag{1}
			\norm{2x+y}^{2}+\norm{y}^{2}=2(\norm{x}^{2}+\norm{x+y}^{2}),\qquad x, y\in H\label{eq:1}
		\end{equation}
		因为上式对 $ \forall x, y\in H $ 成立, 将 $ y $ 替换成 $ \imag y, \imag^{2} y, \imag^{3} y $ 得
		\begin{align}
			\norm{2x+\imag y}^{2}+\norm{y}^{2}& =2(\norm{x}^{2}+\norm{x+\imag y}^{2})\tag{2}\label{eq:i}\\
			\norm{2x-y}^{2}+\norm{y}^{2} & =2(\norm{x}^{2}+\norm{x-y}^{2})\tag{3}\label{eq:i2}\\
			\norm{2x-\imag y}^{2}+\norm{y}^{2} & =2(\norm{x}^{2}+\norm{x-\imag y}^{2})\label{eq:i3}\tag{4}
		\end{align}
		则 $ \eqref{eq:1}+\imag\cdot\eqref{eq:i}+\imag^{2}\cdot\eqref{eq:i2}+\imag^{3}\cdot\eqref{eq:i3} $ 即可得 $ \lrangle{2x, y}=2\lrangle{x, y} $, 再由
		\[
			\lrangle{2x, y}=2\lrangle{x, y}=2\baro{\lrangle{y, x}}=\baro{\lrangle{2y, x}}=\lrangle{x, 2y}
		\]
		可知 $ \lrangle{x, 2y}=2\lrangle{x, y} $. 再说明 $ \lrangle{x_{1}+x_{2}, y}=\lrangle{x_{1}, y}+\lrangle{x_{2}, y} $ 成立. 由平行四边形公式, 有
		\begin{equation}\tag{1'}
			\norm{x_{1}+x_{2}, y}^{2}+\norm{x_{1}-x_{2}}^{2}=2\left( \norm{x_{1}+\frac{y}{2}}^{2}+\norm{x_{1}+\frac{y}{2}}^{2} \right)
		\end{equation}
		类似地, 将 $ y $ 替换为 $ \imag y $, $ \imag^{2}y $, $ \imag^{3}y $ 可得 $ (2'), (3'), (4') $, 即有
		\[
			\lrangle{x_{1}+x_{2}, y}=2\lrangle{x_{1}, \frac{y}{2}}+2\lrangle{x_{2}, \frac{y}{2}}=\lrangle{x_{1}, y}+\lrangle{x_{2}, y}.
		\]

		下证对 $ \forall\lambda\in\C $
		\begin{equation}\label{eq:内积数乘}
			\lrangle{\lambda x, y}=\lambda\lrangle{x, y}
		\end{equation}
		成立. 由 $ \lambda=2 $ 的情形可知\,\eqref{eq:内积数乘}\,对任意 $ n\in\N $ 成立, 再由
		\[
			\lrangle{x-x, y}=\lrangle{x, y}+\lrangle{-x, y}=0
		\]
		可知 $ \lrangle{-x, y}=-\lrangle{x, y} $, 即\,\eqref{eq:内积数乘}\,对任意 $ \lambda\in\Z $ 成立. 再由
		\[
			\lrangle{x, y}=n\lrangle{\frac{1}{n}x, y}
		\]
		可知 $ \frac{1}{n}\lrangle{x, y}=\lrangle{\frac{1}{n}x, y} $, 即\,\eqref{eq:内积数乘}\,对任意 $ \lambda\in\Q $ 成立. 由范数的连续性可知对任意 $ \lambda\in\R $ 成立. 再由
		\[
			\lrangle{\imag x, y}=\frac{1}{4}\sum_{k=0}^{3}\imag^{k}\norm{\imag x+\imag^{k}y}^{2}=\frac{\imag}{4}\sum_{k=0}^{3}\imag^{k}\norm{\imag x+\imag^{k}y}^{2}=\imag\lrangle{x, y}
		\]
		知\,\eqref{eq:内积数乘}\,对任意 $ \lambda\in\C $ 成立.\qed
	\end{Proof}

\section{投影算子}
	\subsection{闭凸集上的投影}
	
	\begin{Definition}[凸集]\label{def:凸集}
		设 $ H $ 是线性空间, $ C\subset H $. 若对 $ \forall x, y\in C $, $ 0\leqslant\lambda\leqslant1 $, 都有
		\[
			\lambda x+(1-\lambda)y\in C,
		\]
		则称 $ C $ 是一个\textbf{凸集}\index{T!凸集}.
	\end{Definition}
	例如 $ \K^{n} $ 中的三角形 $ T $, 圆盘 $ D $ 和线性空间 $ E $ 的线性子空间都是凸集.
	
	\begin{Proposition}
		设 $ (C_{i})_{i\in\alpha} $ 是 $ H $ 上的一族凸集, 则 $ \bigcap_{i\in\alpha}C_{i} $ 也是凸集.
	\end{Proposition}

	\begin{Definition}[凸包]\label{def:凸包}\index{T!凸包}
		 设 $ H $ 是一个线性空间, $ A\subset H $. 称包含 $ A $ 的最小凸集是 $ A $ 的\textbf{凸包}, 记作 $ \conv(A) $. 或等价地, 记包含 $ A $ 的凸集全体为 $ \mathcal{C} $, 则 $ \conv(A)=\bigcap \mathcal{C} $. 
	\end{Definition}

	\begin{Proposition}
		$ \conv(A)=\left\{ \sum\limits_{i=1}^{n}\lambda_{i}x_{i}:\sum\limits_{i=1}^{n}\lambda_{i}=1, \lambda_{i}>0, x_{i}\in A, n\in \N \right\} $. 
	\end{Proposition}
	
	\begin{Proof}
		记右侧集合为 $ B $, 因为 $ A\subset B $ 且 $ B $ 是凸集, 由凸包定义有 $ \conv(A)\subset B $. 再说明反向不等式成立. 因为 $ \sum\limits_{i=1}^{n}\lambda_{i}x_{i}\in C $, 其中 $ C\supset A $ 且 $ C $ 是凸集, 故有 $ \sum\limits_{i=1}^{n}\lambda_{i}x_{i}\in\conv(A) $. 从而有 $ B\subset\conv(A) $. 即 $ \conv(A)=B $.\qed
	\end{Proof}

	\begin{Theorem}[闭凸集投影定理]
		设 $ H $ 是 Hilbert空间, $ C\subset H $ 是非空的闭凸子集, 则有:
		\begin{enumerate}[(1)]
			\item $ \forall x\in H\,\exists!y\in C\,(\norm{x-y}=d(x, C)) $, 并称 $ y $ 是 $ x $ 在$ C $ 上的\textbf{投影}, 记作 $ P_{C}(x) $;
			\item 对$ \forall y\in H $, $ y=P_{C}(x) $ 的充分必要条件是 $ \Re\lrangle{x-y, z-y}\leqslant0 $;
			\item 映射 $ x\mapsto P_{C}(x) $ 是常数为 $ 1 $ 的 Lipschitz映射, 即 $ \forall x, x'\in H $, 有
			\[
				\norm{P_{C}(x)-P_{C}(x')}\leqslant \norm{x-x'};
			\]
			\item 投影算子是幂等的, 即 $ P^{2}_{C}=P_{C} $, 且 $ P_{C}(H)=C $. 
		\end{enumerate}
	\end{Theorem}
	
	\begin{Proof}
		(1) 令 $ d=d(x, C)=\inf\limits_{z\in C}\norm{x-z} $, 由定义知
		\[
			\forall n\in\N\,\exists y_{n}\in C\,\left(d\leqslant\norm{x-y_{n}}\leqslant d+\frac{1}{n}\right),
		\]
		从而得到一列序列 $ (y_{n})_{n\geqslant1} $, 那么由
		\[
			\begin{aligned}
				\norm{y_{n}-y_{m}}^{2} & =2(\norm{x-y_{n}}^{2}+\norm{x-y_{m}}^{2})-\norm{2x-(y_{m}+y_{n})}^{2}\\
				& \leqslant 2\left( \left( d+\frac{1}{n} \right)^{2}+\left( d+\frac{1}{m} \right)^{2} \right)-4d^{2}\\
				& =\frac{2d}{n}+\frac{2d}{m}+\frac{1}{n^{2}}+\frac{1}{m^{2}}\to 0,\qquad n,m\to \infty
			\end{aligned}
		\]
		其中第一个不等号是因为
		\[
			\norm{2x-(y_{m}+y_{n})}^{2}=4\norm{x-\frac{y_{m}+y_{n}}{2}}^{2}\leqslant4d^{2}
		\]
		从而 $ (y_{n})_{n\geqslant1} $ 是 Cauchy列, 则 $ \exists y\in H $ 使得 $ \lim\limits_{n\to\infty}y_{n}=y $, 因为 $ C $ 是闭集, 则 $ y\in C $ 且 $ \norm{x-y}=d $.

		再证唯一性. 设 $ y'\in C $ 使得 $ \norm{x-y'}=d $, 则
		\[
			\begin{aligned}
				0\leqslant\norm{y-y'}^{2} & =2(\norm{x+y}^{2}+\norm{x-y}^{2})-\norm{2x-(y+y')}^{2}\\
				 & \leqslant 2(d^{2}+d^{2})-4d^{2}=0.
			\end{aligned}
		\]
		即 $ \norm{y-y'}=0 $, 也即 $ y=y' $.

		(2) \textsl{必要性}. 设 $ y=P_{C}(x) $. 则 $ \forall z\in C $, 有
		\[
			\begin{aligned}
				\norm{x-y}^{2}\leqslant\norm{x-z}^{2} & = \norm{(x-y)-(z-y)}^{2}
				 & =\norm{x-y}^{2}-2\Re\lrangle{x-y, z-u}+\norm{z-y}^{2},
			\end{aligned}
		\]
		即 $ 2\Re\lrangle{x-y, z-y}\leqslant\norm{z-y}^{2} $. 令 $ z'=\lambda y+(1-\lambda)z\in C $, 将上式中的 $ z $ 替换为 $ z' $, 有
		\[
			2\Re\lrangle{x-y, (1-\lambda)(z-y)}\leqslant\norm{(1-\lambda)(z-y)}^{2},
		\]
		即 $ 2(1-\lambda)\Re\lrangle{x-y, z-y}\leqslant(1-\lambda)^2\norm{z-y}^{2} $, 令 $ \lambda\to 1 $ 可得 $ \Re\lrangle{x-y, z-y}\leqslant0 $.
		
		\textsl{充分性}. 由 $ \forall z\in C\,(\Re\lrangle{x-y, z-y}\leqslant0) $, 有
		\[
			\begin{aligned}
				\norm{x-z}^{2} & = \norm{(x-y)-(z-y)}^{2}\\
				& =\norm{x-y}^{2}-2\Re\lrangle{x-y, z-y}+\norm{z-y}^{2}\geqslant\norm{x-y}^{2}.
			\end{aligned}
		\]
		从而 $ \norm{x-y}\leqslant\norm{z-y}, \forall z\in C $, 即 $ y=P_{C}(x) $.

		(3) $ \forall x, x'\in H $, 取 $ y=P_{C}(x), y'=P_{C}(x') $, 则
		\[
			\norm{y-y'}^{2}=\lrangle{y-y', y-y'}=\lrangle{y-x, y-y'}+\lrangle{x-x', y-y'}+\lrangle{x'-y', y-y'},
		\]
		注意到左侧为实数, 两侧取实部有
		\[
			\begin{aligned}
				\norm{y-y'}^{2} & =\Re\lrangle{y-x, y-y'}+\Re\lrangle{x-x', y-y'}+\Re\lrangle{x'-y', y-y'}\\
				& \leqslant \Re\lrangle{x-x', y-y'}\leqslant \norm{x-x'}\norm{y-y'},
			\end{aligned}
		\]
		其中第一个不等号因为\,(2)\,的必要性, 即有 $ \norm{y-y'}\leqslant\norm{x-x'} $, 即 $ \norm{P_{C}(x)-P_{C}(x')}\leqslant \norm{x-x'} $.
		
		(4) $ \forall x\in H, P_{C}(x)\in C $, 故 $ P_{C}(P_{C}(x))=P_{C}(x) $, 从而 $ P_{C}^{2}=P_{C} $. 且由上可知 $ P_{C}(C)=C $, 所以 $ P_{C}(H)=C $.\qed
	\end{Proof}

	\begin{Remark}
		这里对上述定理进行一些说明
		\begin{enumerate}[(1)]
			\item $ P_{C} $ 不是线性算子(因为像空间 $ C $ 未必是线性空间), 但若 $ C $ 是 $ H $ 的闭线性子空间时, $ P_{C} $ 是线性算子;
			\item 证明中实际只使用了 $ C $ 的完备性. 因为若 $ H $ 是任意的内积空间, 只需 $ C $ 是 $ H $ 中的完备凸集即可.
		\end{enumerate}
	\end{Remark}

	\subsection{正交性\ \ 投影线性算子}

	\begin{Definition}[正交, 正交补]\label{def:正交, 正交补}\index{Z!正交}
		 设 $ H $ 是内积空间,  若 $ x, y\in H $ 使 $ \lrangle{x, y}=0 $, 则称 $ x $ 与 $ y $ \textbf{正交}, 记作 $ x\bot y $. 对任意的 $ A\subset H $, 称:
		 \[
			A^{\bot}=\{ x\in H: x\bot y, \forall y\in A \} 
		 \]
		 为 $ A $ 在 $ H $ 中的\textbf{正交补}.
	\end{Definition}

	\begin{Remark}
		有关正交性与正交补的注记:
		\begin{enumerate}[(1)]
			\item 对 $ x\ne0, y\ne 0 $, 可定义向量的夹角
			\[
				\cos\theta=\frac{\Re\lrangle{x, y}}{\norm{x}\norm{y}},\qquad \theta\in[0, \pi]
			\]
			则有\textbf{余弦定理}
			\[
				\norm{x+y}^{2}=\norm{x}^{2}+\norm{y}^{2}+2\norm{x}\norm{y}\cos\theta,
			\]
			特别地, 若 $ x\bot y $, 上式退化为\textbf{勾股定理}: $ \norm{x+y}^{2}=\norm{x}^{2}+\norm{y}^{2} $. 但反之不成立, 由 $ \norm{x+y}^{2}=\norm{x}^{2}+\norm{y}^{2} $ 只能推出 $ \Re\lrangle{x, y}= 0 $.
			\item 由内积的连续性, 知 $ A^{\bot} $ 是 $ H $ 的闭线性子空间, 且
			\[
				A^{\bot}=\baro{A}^{\bot}=(\Span A)^{\bot}=\baro{\Span A}^{\bot}.
			\]
		\end{enumerate}
		\begin{Theorem}[投影线性算子]
			 设 $ H $ 是 Hilbert 空间, $ E\subset H $ 是闭线性子空间,  对任意 $ x\in H $, $ P_{E}(x) $ 是满足 $ x\bot y\in E $ 的唯一元素 $ y $, 且 $ P_{E} $ 是从 $ H $ 到 $ E $ 的线性算子, 其范数 $ \norm{P_{E}}\leqslant1 $.
		\end{Theorem}
			
		\begin{Proof}
			先说明 $ P_{E}(x) $ 唯一. 因为
			\[
				\begin{aligned}
					y=P_{E}(x) & \Longleftrightarrow \forall z\in E\,(\Re\lrangle{x-y, z-y}\leqslant0)\\
					& \Longleftrightarrow \forall z\in E\,(\Re\lrangle{x-y, z}\leqslant0)\\
					& \Longleftrightarrow \forall z\in E\,(\Re\lrangle{x-y, \lambda z}\leqslant0, \forall \lambda\in \K)\\
					& \Longleftrightarrow \forall z\in E\,(\lrangle{x-y, z}=0)\Longleftrightarrow x-y\bot E
				\end{aligned}
			\]

			再说明 $ P_{E} $ 是线性的. 因为
			\[
				(x+x')-(P_{E}(x)+P_{E}(x'))=(x-P_{E}(x))+(x'-P_{E}(x'))\bot E
			\]
			由唯一性可知 $ P_{E}(x+x')=P_{E}(x)+P_{E}(x') $. 且
			\[
				\lambda x-\lambda P_{E}(x)=\lambda(x-P_{E}(x))\bot E
			\]
			由唯一性可知 $ P_{E}(\lambda x)=\lambda P_{E}(x) $, 从而 $ P_{E} $ 是线性算子. 而且
			\[
				\norm{P_{E}}=\sup_{\norm{x}=1}\norm{P_{E}(x)}=\sup_{\norm{x}=1}\norm{P_{E}(x)-P_{E}(0)}\leqslant\sup_{\norm{x}=1}\norm{x}=1,
			\]
			且若 $ E\ne \{ 0 \} $, 即 $ \exists x\ne 0, x\in E $ 使 $ P_{E}(x)=\norm{x} $, 则 $ E\ne 0 $ 时有 $ \norm{P_{E}}=1 $.\qed
		\end{Proof}
		 
		\begin{Example}
			在 $ \mathbb{M}_{n}(\C) $ 上构造投影算子, 由幂等性可知其特征值非$0$即$1$, 从而可得一平凡构造
			\[
				P=\begin{bmatrix}
					\mathds{1}_{k} & 0 \\
					0 & 0
				\end{bmatrix}
			\]
			其中 $ \mathds{1}_{k} $ 表示阶数为 $ k $ 的单位矩阵, 取 $ e_{1}, e_{2},\dots,e_{n} $ 为 $ \C^{n} $ 的一组规范正交基, $ e_{1}, e_{2},\dots,e_{k} $ 为 $ E\subset\C^{n} $ 的一组规范正交基, 则
			\[
				P_{E}(x)=\sum_{i=1}^{k}\lambda_{i}e_{i}=\sum_{i=1}^{k}\lrangle{x, e_{i}}e_{i}
			\]
		\end{Example}
	\end{Remark}

	\begin{Corollary}[正交分解]
		设 $ H $ 是Hilbert空间, $ E $ 是 $ H $ 的线性子空间, 则
		\[
			H=\baro{E}\oplus E^{\bot}
		\]
		即 $ \forall x\in H $, 存在唯一分解 $ x=y+z $, $ y\in\baro{E}, z\in E^{\bot} $, 且 $ \norm{x}^{2}=\norm{y}^{2}+\norm{z}^{2} $.
	\end{Corollary}

	\begin{Proof}
		$ \forall x\in H $, 取 $ y=P_{E}(x)\in \baro{E} $, 则 $ z=x-y $, $ z\bot E $. 也即 $ z\in E^{\bot} $. 从而
		\[
			x=y+z, \qquad y\in \baro{E}, z\in E^{\bot}
		\]
		此时 $ \lrangle{y, z}=0 $, 故
		\[
			\norm{x}^{2}=\norm{y+z}^{2}=\norm{y}^{2}+\norm{z}^{2}.		
		\]
		再说明这样的分解是唯一的. 若还有 $ x=y'+z' $, $ y'\in\baro{E} $, $ z'\in E^{\bot} $. 则
		\[
			y+y'=z+z' \Longrightarrow y'-y=z-z'\in \baro{E}\cap E^{\bot}.
		\]
		从而只能有 $ y-y'=z'-z=0 $, 即 $ y=y', z=z' $.\qed
	\end{Proof}

	\begin{Corollary}
		设 $ H $ 是Hilbert空间, $ E $是 $ H $ 的线性子空间, 则 $ (E^{\bot})^{\bot}=E $.
	\end{Corollary}

	\begin{Proof}
		由定义得 $ E\subset (E^{\bot})^{\bot} $, 又因为正交补空间是闭线性子空间, 故 $ \baro{E}\subset (E^{\bot})^{\bot} $. 再证反向不等式. 因为 $ \forall x\in(E^{\bot})^{\bot}  $, 都有 $ P_{E^{\bot}}(x)=0 $, 则
		\[
			x=P_{\baro{E}}(x)+P_{E^{\bot}}(x)=P_{\baro{E}}(x)
		\]
		说明 $ x\in\baro{E} $, 即 $ (E^{\bot})^{\bot}\subset \baro{E} $. 故 $ (E^{\bot})^{\bot}=E $.\qed
	\end{Proof}

	\begin{Remark}
		设 $ H $ 是Hilbert空间, $ A\subset H $, 则有 $ (A^{\bot})^{\bot}=\baro{\Span A} $(因为 $ A^{\bot}=\baro{\Span A}^{\bot} $). 特别地, 若 $ A=\{ x \} $, 则 $ (A^{\bot})^{\bot}=\K x $.
	\end{Remark}

\section{对偶与共轭}

	考虑 $ L_{p}(X), 1\leqslant p\leqslant\infty $. 由H\"older不等式, 可以在 $ L_{p}(X) $ 上构造出一个线性泛函, 即 $ \forall g\in L_{q}(X) $, $ (p, q) $ 是一对共轭指数, 可定义:
	\[
		\rho_{g}(f)=\int_{X}fg\diff\mu.
	\]
	则由 $ \abs{\rho_{g}(f)}\leqslant\norm{f}_{p}\norm{g}_{q} $ 知 $ \norm{\rho_{g}}\leqslant\norm{g}_{q}<\infty $, 从而 $ \rho_{g} $ 是有界线性泛函. 

	特别地, 对 $ p=q=2 $, 因为 $ L_{2}(X) $ 是Hilbert空间, 其上有内积 $ \lrangle{f, g}=\int_{X}f\baro{g}\diff\mu $, 则 $ \forall y\in H $, 可定义映射 $ \varphi_{y}:x\mapsto \lrangle{x, y} $, 有 $ \norm{\varphi_{y}}\leqslant\norm{y} $, 从而 $ H $ 到 $ H^{*} $ 上存在单射.

	\begin{Theorem}[Riesz表示定理]
		 设 $ H $ 是 \K 上的Hilbert空间, 则 $ \varphi: H\to \K $ 是一个连续线性泛函的充分必要条件是 $ \exists y\in H\,\forall x\in H\,(\varphi(x)=\lrangle{x, y}) $, 且由此所得 $ y $ 唯一, 有 $ \norm{\varphi}=\norm{y} $.
	\end{Theorem}

	\begin{Proof}
		\textsl{必要性}. 设 $ \varphi\in H^{*} $, 取 $ E=\ker\varphi $. 因为 $ \varphi $ 是一个连续线性泛函, 故 $ E=\ker\varphi $ 是一个闭线性子空间. 若 $ E=H $, 则 $ \varphi=0 $. 此时 $ y=0 $. 否则 $ E^{\bot}\ne\{0\} $, 则存在 $ e\ne0 $, $ e\in E^{\bot} $ 使得 $ \varphi(e)\ne0 $. 不妨令 $ \varphi(e)=1 $, 则 $ x $ 有正交分解
		\[
			x=(x-\varphi(x)e)+\varphi(x)e,
		\]
		记 $ x-\varphi(x)e=x' $. 因为 $ \varphi(x')=\varphi(x)-\varphi(x)\varphi(e)=0 $, 则 $ x'\in E $, 而因为 $ e\in E^{\bot} $, 那么对任意 $ z\in E $, 有 $ \lrangle{z, \varphi(x)e}=\varphi(x)\lrangle{z, e}=0 $, 则 $ \varphi(x)e\in E^{\bot} $. 那么
		\[
			\begin{aligned}
				\lrangle{x', e}=0\Longrightarrow \lrangle{x, e} & =\lrangle{x'+\varphi(e), e}\\
				& =\varphi(x)\lrangle{e, e},
			\end{aligned}
		\]
		则
		\[
			\varphi(x)=\frac{1}{\norm{e}^{2}}\lrangle{x, e}=\lrangle{x, \frac{e}{\norm{e}^{2}}}
		\]
		即 $ y=e/\norm{e}^{2} $. 若存在 $ y' $, 使得 $ \varphi(x)=\lrangle{x, y'}=\lrangle{x, y} $, 则 $ \lrangle{x, y-y'}=0 $, 即 $ y=y' $. 故唯一性得证. 且
		\[
			\norm{\varphi}=\sup_{\norm{x}=1}=\sup_{\norm{x}=1}\lrangle{x, y}\leqslant\norm{y},
		\]
		取 $ x=y/\norm{y} $ 后, 由 $ \varphi(x)=\norm{y} $ 知 $ \norm{\varphi}=\norm{y} $.

		\textsl{充分性}. 由 Cauchy-Schwarz不等式, 有
		\[
			\abs{\varphi}=\abs{\lrangle{x, y}}\leqslant\norm{x}\norm{y} \Longrightarrow \norm{\varphi}\leqslant\norm{y}<\infty.
		\]
		从而 $  \varphi\in H^{*} $. \qed
	\end{Proof}

	\begin{Remark}~
		\begin{enumerate}[(1)]
			\item 由证明过程可知
			\[
				\norm{y}=\norm{\varphi_{y}}=\sup_{\norm{x}=1}\abs{\lrangle{x, y}}
			\]
			实际上对 $ \forall y\in H $ 成立. 从而 $ \forall u\in \CB(H, K) $, 其中 $ H, K $ 都是 Hilbert空间, 有
			\[
				\norm{u}=\sup_{\norm{x}=1}\norm{u(x)}=\sup_{\norm{x}=1}\sup_{\norm{y}=1}\abs{\lrangle{u(x), y}}.
			\]
			\item 考虑映射 $ \varPhi: H\to H^{*}, y\mapsto \varphi_{y} $, 则它是共轭线性的等距双射, 即 $ H $ 与 $ H^{*} $ 在等距意义下可看作同一空间.
		\end{enumerate}
	\end{Remark}

	\begin{Theorem}[伴随算子]
		设 $ H, K $ 是 Hilbert空间, $ u\in \CB(H, K) $, 则存在唯一的 $ \Star{u}\in \CB(K, H) $ 使得
		\[
			\forall x\in K\,\forall y\in H\,\big(\lrangle{\Star{u}(x), y}=\lrangle{x, u(y)}\big),
		\] 
		且 $ \norm{\Star{u}}=\norm{u} $. 称 $ \Star{u} $ 为 $ u $ 的伴随. 
	\end{Theorem}

	\begin{Proof}
		考虑映射 $ y\mapsto\lrangle{u(y), x} $, 由
		\[
			\abs{\lrangle{u(y), x}}\leqslant\norm{u}\norm{y}\norm{x}
		\]
		知它是连续线性泛函, 由 Riesz表示定理
		\[
			\exists!z_{x}\in H\,\forall y\in H\,(\lrangle{y, z_{x}}=\lrangle{u(y), x}),
		\]
		由此定义映射 $ \Star{u}: K\to H, x\mapsto z_{x} $, 则有
		\[
			\lrangle{y, \Star{u}(x)}=\lrangle{y, z_{x}}=\lrangle{u(y), x},
		\]
		而由
		\[
			\begin{aligned}
				\lrangle{y, \Star{u}(x+x')} & =\lrangle{u(y), x+x'}=\lrangle{u(y), x}+\lrangle{u(y), x'}\\
				& =\lrangle{y, \Star{u}(x)}+\lrangle{y, \Star{u}(x')}=\lrangle{y, \Star{u}x+\Star{u}x'}, \qquad \forall y\in H,
			\end{aligned}
		\]
		可知 $ \Star{u}(x+x')=\Star{u}x+\Star{u}(x') $. 类似可证 $ \Star{u}(\lambda x)=\lambda\Star{u}(x) $, 从而 $ \Star{u}  $ 是线性算子, 且
		\[
			\norm{\Star{u}}=\sup_{\norm{x}=1}\sup_{\norm{y}=1}\abs{\lrangle{\Star{u}(x), y}}=\sup_{\norm{x}=1}\sup_{\norm{y}=1}\abs{\lrangle{x, u(y)}}=\norm{u}. 
		\]
		由 $ u\in \CB(H, K) $ 知 $ \Star{u}\in\CB(K, H) $.\qed
	\end{Proof}
	
	\begin{Remark}~
		\begin{enumerate}[(1)]
			\item 特别地, $ A\in\mathbb{M}_{n}(\C) $ 时, $ \Star{A}=A^{H} $;
			\item $ u\in\CB(H, K) $, 有 $ \Star{(\Star{u})}=u $;
			\item 映射 $ u\mapsto \Star{u} $ 是共轭线性的等距双射;
			\item 设 $ H, K, J $ 都是Hilbert空间, $ u\in\CB(H, K), v\in\CB(K, J) $, 则有 $ \Star{(vu)}=\Star{u}\Star{v} $, 而若 $ u\in\CB(H) $, $ u $ 可逆, 有
			\[
				\Star{(uu^{-1})}=\id_{H}=\Star{(u^{-1})}\Star{u},
			\]
			即 $ \Star{(u^{-1})}=(\Star{u})^{-1} $;
			\item 若 $ u\in\CB(H) $, $ \Star{u}=u $, 则称 $ u $ 是\textbf{自伴}的, 例如 $ M_{g}: f\mapsto gf $ 是自伴的, 对 $ A\in\mathbb{M}_{n}(\R) $, $ A $ 自伴当且仅当 $ A $ 对称.
		\end{enumerate}
	\end{Remark}
	\begin{Definition}[酉算子]\index{Y!酉算子}\label{def:酉算子}
			 设 $ u\in \CB(H) $, 若 $ u\Star{u}=\Star{u}u=\id_{H} $, 则称 $ u $ 是\textbf{酉算子}.
	\end{Definition}
	\begin{Remark}
		下面对酉算子进行一些说明
		\begin{enumerate}[(1)]
			\item 若 $ u $ 是酉算子, 则 $ \Star{u}=u^{-1} $, 此时有
			\[
				\lrangle{u(x), u(y)}=\lrangle{x, y}=\lrangle{\Star{u}(x), \Star{u}(y)};
			\]
			\item 设 $ u, v $ 是酉算子, 则 $ u^{-1} $ 是酉算子, $ \id $ 是酉算子, $ uv $ 也是酉算子, $ \CB(H) $ 中所有的酉算子关于乘法构成一个群.
		\end{enumerate}
	\end{Remark}

	\begin{Example}~
		\begin{enumerate}[(1)]
			\item $ u=\mathrm{diag}\{ \exp(\imag \theta_{1}), \exp(\imag\theta_{2}), \dots, \exp(\imag\theta_{n}) \} $ 是一个酉算子;
			\item 若
		$ \left[\begin{smallmatrix}
		x_{1} & x_{2}\\
		x_{3} & x_{4}	
		\end{smallmatrix}\right] $ 是酉算子, $ x_{i}\in\R $, 则 $ \exists\theta $ 使 
		$ \left[\begin{smallmatrix}
			x_{1} & x_{2}\\
			x_{3} & x_{4}
		\end{smallmatrix}\right]=\left[\begin{smallmatrix}
			\cos\theta & \sin\theta \\
			-\sin\theta & \cos\theta
		\end{smallmatrix}\right] $;
		\item $ M_{g} $ 是酉算子 $ \Longleftrightarrow\abs{g}=1\quad \mathrm{a.e.} $.
		\end{enumerate}
	\end{Example}

\section{正交基}
	\subsection{正交与正交基}
	设 $ H $ 是Hilbert空间, $ E $ 是 $ H $ 的闭线性子空间, 由正交分解可知 $ H=E\oplus E^{\bot} $. 令 $ E=\K x_{1}, \norm{x_{1}}=1 $, 则 $ H=\K x_{1}\oplus (\K x_{1})^{\bot} $, 再取 $ x_{2}\in (\K x_{1})^{\bot}, \norm{x_{2}}=1 $, 则 $ H=\K x_{1}\oplus \K x_{2}\oplus (\K\{ x_{1}, x_{2} \})^{\bot} $, 如此操作下去, 可得
	\[
		H=\K x_{1}\oplus \K x_{2}\oplus\cdots\oplus\K x_{n}\oplus(\K \{ x_{1}, x_{2}, \dots, x_{n} \})^{\bot}
	\]
	且 $ \norm{x_{i}}=1 $. 由 Zorn引理, $ H=\baro{\K\{ x_{i} \}_{i\in\alpha}} $, 其中 $ \norm{x_{i}}=1 $ 且 $ (x_{i})_{i\in\alpha} $ 两两正交, 有 $ \Span(x_{i})_{i\in\alpha}=H $. 
	
	\begin{Definition}[规范正交基]\index{Z!正交}\index{W!完全}\index{G!规范正交}\index{G!规范正交基}
	设$ \alpha $是指标集, $ H $是Hilbert空间, $ (e_i)_{i\in\alpha} $是$ H $中的一族向量.
	\begin{enumerate}[(1)]
	\item 若$ \forall i\ne j\,(e_i\bot e_j) $, 则称$ (e_i)_{i\in\alpha} $是\textbf{正交}的.
	\item 若$ (e_i)_{i\in\alpha} $正交且$ \forall i\in\alpha\,(\norm{e_i}=1) $, 则称$ (e_i)_{i\in\alpha} $是\textbf{规范正交}的.
	\item 若$ (e_i)_{i\in\alpha} $的线性扩张在$ H $中稠密, 即$ \baro{\Span (e_i)_{i\in\alpha}}=H $, 则称$ (e_i)_{i\in\alpha} $是\textbf{完全}的.
	\item 若$ (e_i)_{i\in\alpha} $是规范正交的且是完全的, 则称$ (e_i)_{i\in\alpha} $是$ H $的一组\textbf{规范正交基}.
	\end{enumerate}
	\end{Definition}
	
	\begin{Example}
	常见空间上的规范正交基:
	\begin{enumerate}[(1)]
	\item 在$ \K^n $上, 取$ \{ e_1, \dots,e_n \} $, 其中$ e_i=[\delta_{1,i},\delta_{2,i}, \dots,\delta_{n,i}]^\mathrm T $, 它是$ \K^n $的经典基(或称标准基/自然基).
	\item 在$ \ell_2 $上, 取$ (e_n)_{n\geqslant 1} $, 其中$ e_n=(\delta_{1,n},\delta_{2,n}, \dots) $, 则$ (e_n)_{n\geqslant 1} $是$ \ell_2 $的一组规范正交基.
	\item 在$ L_2[0,2\pi] $上(或同构地, $ L_2(\mathbb{T}) $上, 其中$ \mathbb{T} $是单位圆周$ \{ \exp(\imag t) : 0\leqslant t<2\pi \} $), 取$ (e_n)_{n\geqslant 1} $, 其中$ e_n=\exp(\imag nt) $. 由Fourier级数理论可知$ (e_n)_{n\geqslant 1} $是$ L_2[0,2\pi] $的一个规范正交基.
	\item 在$ L_2(\R) $上, 取Hermite多项式
	\[
	H_n(x)=(-1)^n\exp(x^2)\left(\frac{\diff}{\diff x}\right)^n\exp(-x^2),\qquad n\geqslant 0
	\]
	(例如$ H_1(x)=1,\ H_2(x)=2x,\ H_3(x)=4x^2-2 $), 注意到
	\[
	\int_{-\infty}^{\infty}H_n(x)H_m(x)\exp(-x^2)\diff x=\begin{cases}
	2^n\cdot n!\cdot\sqrt{\pi} & ,n=m\\ 0 & ,n\ne m
	\end{cases}
	\]
	故取$ (e_n)_{n\geqslant 1} $, 其中
	\[
	e_n=\frac{1}{\sqrt{2^n\cdot n!\cdot\sqrt{\pi}}}H_n(x)\exp\left(-\frac{x^2}{2}\right)
	\]
	即可.
	\end{enumerate}
	\end{Example}
	
	\begin{Proposition}\label{prop:投影算子代数表达}
	下面给出投影算子的代数表达: 设$ H $是Hilbert空间, $ \{ e_1, \dots,e_n \} $是$ H $的规范正交集, 令$ E=\Span\{ e_1,e_2, \dots,e_n \} $, 则$ \forall x\in H $, 有
	\[
	P_E(x)=\sum_{i=1}^n\lrangle{x,e_i}e_i,\qquad\text{且}\qquad \norm{x}^2=\norm{x-P_E(x)}^2+\sum_{i=1}^n\abs{\lrangle{x,e_i}}^2.
	\]
	\end{Proposition}
	\begin{Proof}
	令$ y=\sum\limits_{i=1}^n\lrangle{x,e_i}e_i $, 注意到$ P_E(x) $是满足$ x-P_E(x)\bot E $的唯一向量, 故只需验证$ \lrangle{x-y,e_i}=0 $即可. 而对$ i=1,2, \dots,n $, 有
	\[
	\lrangle{x-y,e_i}=\lrangle{x,e_i}-\lrangle{y,e_i}=\lrangle{x,e_i}-\lrangle{x,e_i}=0.
	\]
	则$ y=P_E(x) $, 再因
	\[
	\begin{aligned}
	\norm{x}^2=\lrangle{x,x}&=\lrangle{x-P_E(x)+P_E(x),x-P_E(x)+P_E(x)}\\
	& =\norm{x-P_E(x)}^2+\norm{P_E(x)}^2=\norm{x-P_E(x)}^2+\sum_{i=1}^n\abs{\lrangle{x,e_i}}^2
	\end{aligned}
	\]
	得证.\qed
	\end{Proof}
	
	利用投影算子的这一代数表达, 可以进一步刻画Hilbert空间上的正交基:
	\begin{Theorem}
	设$ H $是Hilbert空间, $ (e_n)_{n\geqslant 1} $是规范正交序列, 则下列叙述等价:
	\begin{enumerate}[(1)]
	\item $ (e_n)_{n\geqslant 1} $是完全的.
	\item 对任意的 $ x\in H $, 存在唯一\K 中序列 $ (x_n)_{n\geqslant 1} $使得$ \sum\limits_{n\geqslant 1}x_ne_n $收敛到$ x $.
	\end{enumerate}
	\end{Theorem}
	\begin{Proof}
	(2) $ \Rightarrow $ (1) : 因为$ \forall x\in H $, 有$ \lim\limits_{n\to\infty}\norm{\sum\limits_{k=1}^nx_ke_k-x}=0 $且$ \sum\limits_{k=1}^nx_ke_k\in\Span(e_n)_{n\geqslant 1} $对$ \forall n\in\N $成立, 从而$ x\in\baro{\Span(e_n)_{n\geqslant 1}} $, 即$ H=\baro{\Span(e_n)_{n\geqslant 1}} $, 这说明$ (e_n)_{n\geqslant 1} $是完全的.
	
	(1) $ \Rightarrow $ (2) : $ \forall x\in H $, 取$ y_n=\sum\limits_{k=1}^n\lrangle{x,e_k}e_k $, 则需验证$ \lim\limits_{n\to\infty}\norm{y_n-x}=0 $. 因为
	\[
	\norm{y_{n+p}-y_n}=\sum_{k=n+1}^{n+p}\abs{\lrangle{x,e_k}}^2,
	\]
	由命题\,\ref{prop:投影算子代数表达}\,可知$ \forall n\in\N $, 都有$ \sum\limits_{k=1}^n\abs{\lrangle{x,e_k}}^2\leqslant\norm{x}^2 $, 令$ n\to\infty $后有$ \sum\limits_{n\geqslant 1}\abs{\lrangle{x,e_n}}^2 $收敛, 从而$ \norm{y_{n+p}-y_n}\to 0 $. 这说明$ (y_n)_{n\geqslant 1} $是Cauchy列, 令$ y=\lim\limits_{n\to\infty}y_n $, 则$ \forall i\in\N $, 都有
	\[
	\lrangle{y-x,e_i}=\lrangle{y,e_i}-\lrangle{x,e_i}=\lim_{n\to\infty}\lrangle{y_n,e_i}-\lrangle{x,e_i}=0,
	\]
	从而$ y=x $, 即$ \lim\limits_{n\to\infty}\sum\limits_{k=1}^n\lrangle{x,e_k}e_k=x $.
	
	令$ x_n=\lrangle{x,e_n} $, 设$ (x_n')_{n\geqslant 1} $也满足$ \lim\limits_{n\to\infty}x_k'e_k=x $, 则
	\[
	x_i=\lrangle{x,e_i}=\lrangle{\lim_{n\to\infty}\sum_{k=1}^nx'_ke_k,e_i}=\lim_{n\to\infty}\lrangle{\sum_{k=1}^nx_k'e_k,e_i}=x_i',
	\]
	从而$ x_i=x_i' $, 即$ \sum\limits_{n\geqslant 1}\lrangle{x,e_n}e_n $是$ x $的唯一级数表示.\qed
	\end{Proof}
	
	\begin{Corollary}[Bessel]
	设$ H $是Hilbert空间, $ (e_n)_{n\geqslant 1} $是规范正交序列, 则$ \forall x\in H $, 都有
	\[
	\sum_{n\geqslant 1}\abs{\lrangle{x,e_n}}^2\leqslant\norm{x}^2.
	\]
	\end{Corollary}
	\begin{Proof}
	因$ \forall n_0\in\N $, 都有$ \sum\limits_{n=1}^{n_0}\abs{\lrangle{x,e_n}}^2\leqslant\norm{x}^2 $, 令$ n_0\to\infty $即可.\qed
	\end{Proof}
	
	\begin{Theorem}[Parseval]
	设$ H $是Hilbert空间, $ (e_n)_{n\geqslant 1} $是$ H $的规范正交基, 则$ \forall x\in H $, 有
	\[
	\norm{x}^2=\sum_{n\geqslant 1}\abs{\lrangle{x,e_n}}^2,
	\]
	更一般地, $ \forall x,y\in H $, 有
	\[
	\lrangle{x,y}=\sum_{n\geqslant 1}\lrangle{x,e_n}\lrangle{e_n,y}.
	\]
	\end{Theorem}
	\begin{Proof}
	因为$ x=\sum\limits_{n\geqslant 1}\lrangle{x,e_n}e_n $, 故有$ \norm{x}^2=\sum\limits_{n\geqslant 1}\abs{\lrangle{x,e_n}}^2 $, 而$ \forall x,y\in H $, 有
	\[
	\lrangle{x,y}=\lrangle{\sum_{n\geqslant 1}\lrangle{x,e_n}e_n,y}=\sum_{n\geqslant 1}\lrangle{\lrangle{x,e_n}e_n,y}=\sum_{n\geqslant 1}\lrangle{x,e_n}\lrangle{e_n,y}.
	\]
	\qed
	\end{Proof}
	
	\subsection{规范正交基的构造}
	
	类似于线性代数课程中所使用的方法, 对于Hilbert空间, 也可以用类似的方法从一个线性无关集得到规范正交集.
	
	\begin{Theorem}[Gram-Schmidt]
	设$ H $是Hilbert空间, $ (f_k)_{k\geqslant 1} $线性无关, 则存在规范正交序列$ (e_k)_{k\geqslant 1} $使得$ \forall n\in\N $, 都有
	\[
	\baro{\Span(e_k)_{1\leqslant k\leqslant n}}=\baro{\Span(f_k)_{1\leqslant k\leqslant n}}.
	\]
	\end{Theorem}
	\begin{Proof}
	\textbf{(Step 1)} 正交化.
	
	取$ g_1=f_1 $, 再取
	\[
	g_2=f_2-\frac{\lrangle{f_2,g_1}}{\lrangle{g_1,g_1}}g_1,
	\]
	则$ g_1\bot g_2 $, 且因$ \{ f_1,f_2 \} $线性无关可知$ g_2\ne 0 $. 再取
	\[
	g_3=f_3-\frac{\lrangle{f_3,g_1}}{\lrangle{g_1,g_1}}g_1-\frac{\lrangle{f_3,g_2}}{\lrangle{g_2,g_2}}g_2,
	\]
	则$ g_1\bot g_3 $, $ g_2\bot g_3 $, 且$ g_3\ne 0 $. 以此下去可得一正交的序列$ (g_k)_{k\geqslant 1} $.
	
	\textbf{(Step 2)} 规范化.
	
	令$ e_n=\sgn g_n $, 则$ (e_k)_{k\geqslant 1} $是一规范正交序列, 由(Step 1)可知
	\[
	\begin{bmatrix}
	g_1\\g_2\\\vdots\\g_n
	\end{bmatrix}=\begin{bmatrix}
	1 & 0 & \cdots & 0\\ \ast & 1 & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots\\ \ast & \ast & \cdots & 1
	\end{bmatrix}\begin{bmatrix}
	f_1\\ f_2\\\vdots\\f_n
	\end{bmatrix},
	\]
	而又有
	\[
	\begin{bmatrix}
	e_1\\e_2\\\vdots\\e_n
	\end{bmatrix}=\begin{bmatrix}
	1/\norm{g_1} & \phantom{1/\norm{g_1}} & \phantom{1/\norm{g_1}} & \phantom{1/\norm{g_1}}\\
	\phantom{1/\norm{g_1}} & 1/\norm{g_2} & \phantom{1/\norm{g_1}} & \phantom{1/\norm{g_1}}\\
	\phantom{1/\norm{g_1}} & \phantom{1/\norm{g_1}} & \ddots & \phantom{1/\norm{g_1}}\\
	\phantom{1/\norm{g_1}} & \phantom{1/\norm{g_1}} & \phantom{1/\norm{g_1}} & 1/\norm{g_n}
	\end{bmatrix}\begin{bmatrix}
	g_1\\g_2\\\vdots\\g_n
	\end{bmatrix},
	\]
	从而有
	\[
	\begin{bmatrix}
	e_1\\e_2\\\vdots\\e_n
	\end{bmatrix}=\begin{bmatrix}
	1/\norm{g_1} & 0 & \cdots & 0\\
	\ast & 1/\norm{g_2} & \cdots & 0\\
	\vdots & \vdots & \ddots & \vdots\\
	\ast & \ast & \cdots & 1/\norm{g_n}
	\end{bmatrix}\begin{bmatrix}
	f_1\\f_2\\\vdots\\f_n
	\end{bmatrix}=A\begin{bmatrix}
	f_1\\f_2\\\vdots\\f_n
	\end{bmatrix}
	\]
	其中
	\[
	\det A=\prod_{k=1}^n\frac{1}{\norm{g_k}}\ne 0,
	\]
	从而$ A $可逆, 于是$ [f_1,f_2, \dots,f_n]^\mathrm T=A^{-1}[e_1,e_2, \dots,e_n]^\mathrm T $, 也即
	\[
	\baro{\Span(e_k)_{1\leqslant k\leqslant n}}=\baro{\Span(f_k)_{1\leqslant k\leqslant n}}
	\]
	\qed
	\end{Proof}
	
	下面的两个定理说明了Hilbert空间都具有规范正交基, 我们从可分的Hilbert空间出发, 因它可以使用Gram-Schmidt方法得到.
	
	\begin{Proposition}
	设$ H $是可分的Hilbert空间, 则$ H $有规范正交基.
	\end{Proposition}
	\begin{Proof}
	设$ (a_n)_{n\geqslant 1} $是$ H $中可数的稠密子集, 且$ a_n\ne 0 $, 依次去掉序列中可以被前部元素的线性组合表示的元素后得到序列$ (v_n)_{n\geqslant 1} $, 则$ (v_n)_{n\geqslant 1} $线性无关, 且$ \baro{\Span(v_n)_{n\geqslant 1}}=H $. 由Gram-Schmidt正交化可得一族规范正交序列$ (e_n)_{n\geqslant 1} $使得
	\[
	\baro{\Span(e_n)_{n\geqslant 1}}=\baro{\Span(v_n)_{n\geqslant 1}}=H,
	\]
	即$ (e_n)_{n\geqslant 1} $是$ H $的规范正交基.\qed
	\end{Proof}
	在上一命题中, 可分性保证了$ \dim E\leqslant\aleph_0 $, 从而Gram-Schmidt正交化可以进行下去. 在去掉该条件之后, 即Hilbert空间可能是不可数维时, 仍然不可避免地要使用Zorn引理.
	
	\begin{Theorem}
	任一Hilbert空间都有规范正交基.
	\end{Theorem}
	\begin{Proof}
	设$ \mathcal F $是$ H $中非空规范正交集全体, 以包含关系为偏序后有$ (\mathcal F,\leqslant) $是一个偏序集. 任取$ \mathcal F $中的全序子集$ \mathcal G $, 那么$ \bigcup\mathcal G $是$ \mathcal G $的一个上界, 由Zorn引理可知$ \mathcal F $有极大元$ M $.
	
	若$ M $不是规范正交基, 则存在$ x $使得$ \norm{x}=1 $且$ x\bot M $, 这时$ \{ x \}\cup M $是规范正交集, 与$ M $的极大性矛盾. 因此$ M $是$ H $的规范正交基.\qed
	\end{Proof}
	
	不过在此之后, 我们大多数情况下都在研究可分的Hilbert空间, 因此Gram-Schmidt正交化在大多数情况下还可以继续使用. 下面是一个Parseval恒等式的推论, 它说明了可分的Hilbert空间都可以等距同构成我们熟悉的空间.
	
	\begin{Corollary}
	设$ H $是可分的Hilbert空间, 则当$ \dim H=n<\aleph_0 $时, $ H\cong\K^n $. 当$ \dim H=\aleph_0 $时, $ H\cong \ell_2 $. 其中$ \cong $表示左右两空间存在线性等距双射.
	\end{Corollary}
	\begin{Proof}
	$ \forall x\in H $, $ x=\sum\limits_{n\geqslant 1}\lrangle{x,e_n}e_n $, 由Parseval恒等式可知
	\[
	\norm{x}=\bigg( \sum_{n\geqslant 1}\abs{\lrangle{x,e_n}}^2 \bigg)^{1/2},
	\]
	定义$ \varPhi : H\to \ell_2 $, $ x\mapsto(\lrangle{x,e_1},\lrangle{x,e_2}, \dots) $, 则$ \norm{\varPhi(x)}=\norm{x} $, 因此$ \varPhi $是一个线性等距单射, 下面证明$ \varPhi $是满的. $ \forall(x_n)_{n\geqslant 1}\in\ell_2 $, 令$ x=\sum\limits_{n\geqslant 1}x_ne_n $, 则
	\[
	\norm{x}=\bigg( \sum_{n\geqslant 1}\abs{x_n}^2 \bigg)^{1/2}<\infty,
	\]
	即存在$ x\in H $使得$ \varPhi(x)=(x_n)_{n\geqslant 1} $, 从而$ \varPhi $是满的.\qed
	\end{Proof}
	\begin{Remark}
	Hilbert正交基与Hamel基不同, 在有限维情形下, Hilbert正交基一定是Hamel基, 而Hamel基也可以由Gram-Schmidt正交化得到Hilbert正交基. 但在无限维情形下, Hilbert基未必是Hamel基, 例如在$ \ell_2 $上取$ (e_n)_{n\geqslant 1} $, 其中$ e_n=(\delta_{1,n},\delta_{2,n}, \dots) $, 考虑$ \sum\limits_{n\geqslant 1}(e_n/n)\in\ell_2 $, 它不能被有限个$ e_n $生成, 从而$ (e_n)_{n\geqslant 1} $不是Hamel基. 反之, Hamel基也未必能生成Hilbert正交基.
	\end{Remark}
	
	\subsection{对投影算子的进一步讨论}
	
	若无特殊说明, 以下$ H $均为Hilbert空间.
	
	\begin{Proposition}
	设$ P_E $是$ H $上到闭线性子空间$ E $的投影算子, 则有$ P_E^*=P_E=P_E^2 $.
	\end{Proposition}
	\begin{Proof}
	只需证明$ P_E^*=P_E $, 即$ \lrangle{P_E(x),y}=\lrangle{x,P_E(y)} $对$ \forall x,y\in H $成立. 由
	\[
	\lrangle{P_E(x),y}=\sum_{i\in\alpha}\lrangle{\lrangle{x,e_i}e_i,y}=\sum_{i\in\alpha}\lrangle{x,e_i}\lrangle{e_i,y}=\sum_{i\in\alpha}\lrangle{x,\lrangle{y,e_i}e_i}=\lrangle{x,P_E(y)},
	\]
	其中$ (e_i)_{i\in\alpha} $是$ E $的规范正交基, 则$ P_E^*=P_E $.\qed
	\end{Proof}
	
	\begin{Proposition}
	设$ P\in\CB(H) $且$ P^*=P=P^2 $, 则存在闭线性子空间$ E\subset H $使得$ P=P_E $.
	\end{Proposition}
	\begin{Proof}
	记$ E=P(H) $, 先证明$ E $是闭的. 设$ (x_n)_{n\geqslant 1}\subset E $使得$ Px_n\to y $, 那么$ P^2x_n\to Py $. 而由$ P=P^2 $可知$ P^2x_n=Px_n $, 从而由极限的唯一性由$ Py=y $, 这说明$ y\in E $, 从而$ E $是闭的.
	
	再说明$ P=P_E $. 取$ (e_i)_{i\in\alpha} $是$ E $的规范正交基, 则
	\[
	Px=\sum_{i\in\alpha}\lambda_ie_i,
	\]
	只需证明$ \lambda_i=\lrangle{x,e_i} $. 而由
	\[
	\lambda_i=\lrangle{Px,e_i}=\lrangle{x,Pe_i}=\lrangle{x,e_i},
	\]
	有$ Px=\sum\limits_{i\in\alpha}\lambda_ie_i=\sum\limits_{i\in\alpha}\lrangle{x,e_i}e_i=P_E(x) $对任意$ x\in H $成立, 于是$ P=P_E $.\qed
	\end{Proof}
	\begin{Remark}
	考虑$ \ker P_E $, 由此可知
	\[
	\begin{aligned}
	\ker P_E=\{ x : P_E(x)=0 \}&=\{ x : \forall y\in H\,(\lrangle{P_E(x),y}=0) \}\\&=\{ x : \forall y\in H\,(\lrangle{x,P_E(y)}=0) \}=E^\bot.
	\end{aligned}
	\]
	\end{Remark}
	
	\begin{Proposition}
	设$ E, F $是$ H $中两个闭线性子空间, 对应的投影算子分别是$ P_E, P_F $, 那么以下条件等价:
	\begin{enumerate}[(1)]
	\item $ E\subset F $;
	\item $ P_FP_E=P_E $;
	\item $ P_EP_F=P_E $;
	\item $ \forall x\in H\,(\norm{P_E(x)}\leqslant\norm{P_F(x)}) $.
	\end{enumerate}
	\end{Proposition}
	\begin{Proof}
	(1) $ \Rightarrow $ (2) : $ \forall x\in H : P_FP_E(x)=P_F(P_E(x))=P_E(x)\Longrightarrow P_FP_E=P_E $.
	
	(2) $ \Rightarrow $ (3) : $ P_FP_E=P_E\Longrightarrow(P_FP_E)^*=P_E^*\Longrightarrow P_EP_F=P_E $.
	
	(3) $ \Rightarrow $ (4) : $ \forall x\in H : \norm{P_E(x)}=\norm{P_EP_F(x)}\leqslant\norm{P_F(x)} $.
	
	(4) $ \Rightarrow $ (1) : $ \forall x\in E : \norm{x}=\norm{P_E(x)}\leqslant\norm{P_F(x)}\leqslant\norm{x}\Longrightarrow\norm{P_F(x)}=\norm{x}\Longrightarrow x\in F $, 从而$ E\subset F $.\qed
	\end{Proof}
	
	\begin{Corollary}
	设$ E $是$ H $中的闭线性子空间, 那么
	\[
	E=\{ x : \norm{P_E(x)}=\norm{x} \}.
	\]
	\end{Corollary}
	\begin{Proof}
	由$ \norm{x-P_E(x)}^2+\norm{P_E(x)}^2=\norm{x}^2 $可知
	\[
	\norm{P_E(x)}=\norm{x}\Longleftrightarrow\norm{x-P_E(x)}=0\Longleftrightarrow x\in E.
	\]
	\qed
	\end{Proof}
	
	对$ H $的两个闭线性子空间, 定义
	\[
	E\lor F=\baro{\{x+y : x\in E, y\in F\}}=\baro{E+F},
	\]
	并定义投影算子的运算$ P_E\lor P_F=P_{E\lor F} $和$ P_E\land P_F=P_{E\cap F} $, 容易验证
	\begin{enumerate}[(1)]
	\item $ (P_E\lor P_F)^\bot=P_{(E\lor F)^\bot}=P_{E^\bot\cap F^\bot}=P_{E^\bot}\land P_{F^\bot} $;
	\item $ (P_E\land P_F)^\bot=P_{(E\cap F)^\bot}=P_{E^\bot\lor F^\bot}=P_{E^\bot}\lor P_{F^\bot} $.
	\end{enumerate}
	
	\begin{Proposition}
	设$ P_E,\ P_F $是$ H $上两个投影算子, 且它们可交换, 即$ P_EP_F=P_FP_E $, 那么
	\begin{enumerate}[(1)]
	\item $ P_E\land P_F=P_EP_F=P_FP_E $;
	\item $ P_E\lor P_F=P_E+P_F-P_EP_F $;
	\item $ E\lor F=E+F $.
	\end{enumerate}
	\end{Proposition}
	\begin{Proof}
	(1) 由
	\[
	(P_EP_F)^2=P_EP_FP_EP_F=P_E^2P_F^2=P_EP_F=(P_FP_E)^*=(P_EP_F)^*
	\]
	可知$ P_EP_F $是投影算子. 记$ K $是$ P_EP_F $的投影空间, 往证$ K=E\cap F $. 因为
	\[
	K=\{ x : \norm{P_EP_F(x)}=\norm{x} \},
	\]
	于是$ E\cap F\subset K $. 又因为$ \forall x\in K $, 都有
	\[
	\norm{x}=\norm{P_EP_F(x)}\leqslant\norm{P_F(x)}\leqslant\norm{x},
	\]
	从而$ \norm{P_F(x)}=\norm{x} $. 这说明$ x\in F $, 同理有$ x\in E $, 从而$ K\subset E\cap F $. 于是$ K=E\cap F $.
	
	(2) 注意到$ P_{E^\bot}P_{F^\bot}=(\id-P_E)(\id-P_F)=P_{F^\bot}P_{E^\bot} $, 从而由(1)可知$ P_{E^\bot}\land P_{F^\bot}=P_{E^\bot}P_{F^\bot} $, 于是
	\[
	P_E\lor P_F=(P_{E^\bot}\land P_{F^\bot})^\bot=\id-(\id-P_E)(\id-P_F)=P_E+P_F-P_EP_F.
	\]
	
	(3) $ \forall x\in E\lor F $, 由(2)有
	\[
	x=P_{E\lor F}(x)=(P_E+P_F-P_EP_F)(x)=P_E(x)+P_F(\id-P_E)(x)\in E+F,
	\]
	这是因为$ P_E(x)\in E $而$ P_F(\id-P_E)(x)\in F $, 故$ E\lor F\subset E+F $, 而反向不等式由定义显然, 从而$ E\lor F=E+F $.\qed
	\end{Proof}
	
	上述定理说明了在$ P_E $与$ P_F $可交换时, $ E\lor F $实际上就是$ E $与$ F $的Minkowski和. 在非交换的情形下, $ P_E\land P_F $也不能简单地表示, 而是与$ \lim\limits_{n\to\infty}(P_EP_F)^n $相等.
	
	设$ (e_n)_{n\geqslant 1} $是$ H $的规范正交基, $ P_N $是闭线性子空间$ \Span\{ e_1,\dots,e_N \} $的投影算子, 注意到$ \lim\limits_{n\to\infty}\norm{\id-P_N}=1 $, 它不能用来诱导拓扑. 于是我们称$ \lim\limits_{N\to\infty}\norm{P_N(x)-x}=0 $, 即$ P_N(x)\to x $刻画的拓扑为强算子拓扑, 而以$ \lrangle{x,e_n}\to 0\,(n\to\infty) $刻画的拓扑为弱拓扑.
	
\section{最小二乘法}
	
	考虑下面的三个问题:
	\begin{enumerate}[(1)]
	\item 实际观测问题: 设几个量满足
	\[
	y=\lambda_1x_1+\lambda_2x_2+\cdots+\lambda_nx_n,
	\]
	观测数据$ m $次(要求$ m>n $)得到$ y^{(j)}, x_1^{(j)},\dots, x_n^{(j)} $, 这里$ j=1,2,\dots,m $. 在此意义下求$ \lambda_1,\dots,\lambda_n $使得
	\[
	\min_{a_1,\dots,a_n}\sum_{j=1}^m\abs{y^{(j)}-\sum_{i=1}^ma_ix_i^{(j)}}^2=\sum_{j=1}^m\abs{y^{(j)}-\sum_{i=1}^m\lambda_ix_i^{(j)}}^2,
	\]
	若将$ [y^{(1)},\dots,y^{(m)}]^\mathrm T $看作$ \R^m $中的向量$ \bm{y} $, 并且类似地有$ \bm{x}_1,\dots,\bm{x}_n $, 即求
	\[
	\min_{a_1,\dots,a_n}\norm{\bm y-\sum_{i=1}^ma_i\bm x_i}=\norm{\bm y-\sum_{i=1}^m\lambda_i\bm x_i}.
	\]
	\item 平方平均逼近: 在函数逼近中, 对任意的$ f\in L_2[0,1] $, 要使用已知的$ \varphi_1,\dots,\varphi_n\in L_2[0,1] $的线性组合按平方平均意义下取到最佳逼近, 即求$ \lambda_1,\dots,\lambda_n $使得
	\[
	\min_{a_1,\dots,a_n}\int_a^b\abs{f(x)-\sum_{i=1}^na_i\varphi_i(x)}^2\diff x=\int_a^b\abs{f(x)-\sum_{i=1}^n\lambda_i\varphi_i(x)}^2\diff x.
	\]
	\item 最佳估计问题: 设$ (\varOmega,\mathcal A,\mu) $是概率空间, 其上可测函数称为随机变量, 记作$ X $. 在随机过程中常对随机变量$ X $用一组随机变量$ X_1,\dots,X_n $线性组合估计
	\[
	\min_{a_1,\dots,a_n}\int_\varOmega\abs{X(\omega)-\sum_{i=1}^na_iX_i(\omega)}^2\diff\mu(\omega)=\int_\varOmega\abs{X(\omega)-\sum_{i=1}^n\lambda_iX_i(\omega)}^2\diff\mu(\omega).
	\]
	\end{enumerate}
	
	以上的三个问题在本质上都是Hilbert空间$ H $上给定$ x $与$ x_1,\dots,x_n $, 求$ \lambda_1,\dots,\lambda_n $满足条件
	\[
	\min_{a_1,\dots,a_n}\norm{x-\sum_{i=1}^na_ix_i}=\norm{x-\sum_{i=1}^n\lambda_ix_i},
	\]
	这样的问题称为\textbf{最小二乘问题}.\index{Z!最小二乘问题}
