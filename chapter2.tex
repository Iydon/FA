% !TeX root = main.tex

\chapter{线性算子与线性泛函}

\section{连续线性映射}

	\begin{Definition}\index{X!线性算子}
		设$ E, F $是$ \K $上的线性空间, 若映射$ u : E\to F $满足
		\[
			\forall \lambda\in\K\,\forall x,y\in E\,(u(\lambda x+y)=\lambda u(x)+u(y)),
		\]
		则称$ u : E\to F $是一个\textbf{线性映射}或\textbf{线性算子}, 并记$ \CL(E,F) $是$ E $到$ F $线性算子的全体.
	\end{Definition}
	
	特别地, 当$ E=F $时, 用$ \CL(E) $记$ \mathcal{L}(E,E) $.
	
	\begin{Example}~
	\begin{enumerate}[(1)]
		\item $ \forall \lambda\in\K $, 定义
		\[
			M_\lambda : E\to E,\qquad x\mapsto\lambda x,
		\]
		则$ M_\lambda\in\CL(E) $. 而对$ y\in E $, 定义
		\[
			T_y : E\to E,\qquad x\mapsto x+y,
		\]
		则$ T_y\notin\CL(E) $.
		
		\item 设$ E=C[0,1] $, 对$ f\in C[0,1] $, 定义$ M_fg=fg $, 则$ M_f $是线性算子. 再取$ x\in[0,1] $, 定义$ \delta_x(f)=f(x) $, 则$ \delta_x $是线性算子, 再定义
		\[
			I(f)(x)=\int_0^xf(t)\diff t,
		\]
	则$ I $也是线性算子.
	\end{enumerate}
	\end{Example}
	
	\begin{Remark}
		关于$ \CL(E,F) $的一些注记:
	\begin{enumerate}[(1)]
	\item $ \CL(E,F) $本身也是一个线性空间, 其上的线性运算可以定义为
	\[
		\begin{aligned}
			\lambda u : E\to F,& \quad x\mapsto\lambda u(x),\\
			u+v : E\to F,& \quad x\mapsto u(x)+v(x),
		\end{aligned}
	\]
	其中$ \lambda\in\K $, $ u, v\in\CL(E,F) $.
	
	\item 对$ u\in\CL(E,F) $, 定义其\textbf{核空间}\index{H!核空间}为
	\[
	\ker u=\{ x\in E : u(x)=0 \}.
	\]
	则$ \ker u $是$ E $的线性子空间, 且$ u $是单射当且仅当$ \ker u=\{0\} $.
	\end{enumerate}
	\end{Remark}
	
	\begin{Theorem}[连续性]\label{thm:线性算子连续性}
	设$ E, F $是$ \K $上的两个赋范空间, 且$ u\in\CL(E,F) $, 则下列命题等价:
	\begin{enumerate}[(1)]
	\item $ u $在$ E $上连续;
	\item $ u $在$ E $上的某一点连续;
	\item $ u $在原点连续;
	\item $ \exists C\geqslant 0\,\forall x\in E\,(\norm{u(x)}\leqslant C\norm{x}) $.
	\end{enumerate}
	\end{Theorem}
	\begin{Proof}
		(1) $ \Rightarrow $ (2) : 显然.
		
		(2) $ \Rightarrow $ (3) : 设$ u $在$ x_0\in E $连续, 那么
		\[
			\forall\varepsilon>0\,\exists r>0\,(x\in B(x_0,r)\Rightarrow\norm{u(x)-u(x_0)}<\varepsilon),
		\]
		则对$ \forall y\in B(0,r) $, 有
		\[
			\norm{u(y)-u(0)}=\norm{u(y)}=\norm{u(x_0+y)-u(x_0)}<\varepsilon,
		\]
		即$ u $在原点连续.
		
		(3) $ \Rightarrow $ (4) : 由$ u $在原点连续可知
		\[
			\exists r_0>0\,(y\in\overline{B(0,r)}\Rightarrow\norm{u(y)}<1).
		\]
		则$ \forall x\in E $, 由
		\[
			\norm{u(x)}=\norm{u\left(\dfrac{xr}{\norm{x}}\right)}\frac{\norm{x}}{r}<\frac{\norm{x}}{r},
		\]
		取$ C=\frac{1}{r} $即可.
		
		(4) $ \Rightarrow $ (1) : 由$ u\in\mathcal{L}(E,F) $, 有
		\[
			\forall x,y\in E\,(\norm{u(x)-u(y)}\leqslant C\norm{x-y}),
		\]
		即$ u $是Lipschitz的, 从而$ u $在$ E $连续.\qed
	\end{Proof}
	
	\begin{Remark}
		上述定理表明在赋范空间上, 连续线性映射都是Lipschitz的, 从而连续线性映射一定一致连续.
	\end{Remark}
	
	\begin{Definition}[算子范数]\index{Y!有界线性算子}
		设$ E,F $都是赋范空间, $ u\in\mathcal{L}(E,F) $. 若
		\[
			\forall C\geqslant 0\,\forall x\in E\,(\norm{u(x)}\leqslant C\norm{x}),
		\]
		则称$ u $是\textbf{有界}的. 再令
		\[
			\norm{u}=\sup_{\norm{x}\ne 0}\frac{\norm{u(x)}}{\norm{x}}
		\]
		称$ \norm{u} $是算子$ u $的\textbf{范数}. 并记$ \CB(E,F) $是$ E $到$ F $的有界线性算子的全体, 且类似地记$ \mathcal{B}(E)=\mathcal{B}(E,E) $.
	\end{Definition}
	
	\begin{Example}
		设$ E=\C^n $, 则$ \mathcal{L}(E)=\mathbb{M}_n(\C)=\mathcal{B}(E) $, 其中$ \mathbb{M}_n(\C) $是$ n $阶复矩阵的全体. 对$ A\in\mathbb{M}_n(\C) $, 定义
		\[
			\norm{A}=\sup_{\norm{x}\ne 0}\frac{\norm{Ax}}{\norm{x}}
		\]
		为$ A $的范数. 则由
		\[
			\norm{A}^2=\sup_{\norm{x}\ne 0}\frac{\norm{Ax}^2}{\norm{x}^2}=\sup_{\norm{x}\ne 0}\frac{\lrangle{Ax,Ax}}{\norm{x}^2}=\sup_{\norm{x}\ne 0}\frac{\lrangle{A^\dagger Ax,x}}{\norm{x}^2}=\sup\{\abs{\lambda}\},
		\]
		可知$ A $是有界线性算子. 其中$ \lambda $是$ A^\dagger A $的特征值.
	\end{Example}
	
	\begin{Remark}~
	\begin{enumerate}[(1)]\label{rmk:范数性质}
		\item $ \CB(E,F) $是$ \CL(E,F) $的线性子空间, 这由
		\[
			\norm{\lambda u}=\abs{\lambda}\norm{u},\qquad \norm{u+v}\leqslant\norm{u}+\norm{v}
		\]
		可知. 且$ (\mathcal{B}(E,F),\norm{\cdot}) $还是一个赋范空间. 由定理\ref{thm:线性算子连续性}可知$ u $连续等价于$ u $有界.
		
		\item $ u $的有界性实际上指$ \norm{u(x)} $在$ E $的有界集上有界. 实际上除非$ u\equiv 0 $, 否则$ \norm{u(x)} $不可能在全空间上有界.
		
		\item\label{rmk:范数性质最小C} 范数$ \norm{u} $也可以等价地定义为
		\[
			\norm{u}:=\sup_{\norm{x}\ne 0}\frac{\norm{u(x)}}{\norm{x}}=\sup_{\norm{x}\leqslant 1}\norm{u(x)}=\sup_{\norm{x}=1}\norm{u(x)},
		\]
		且$ \norm{u} $就是定义中满足条件的$ C $中最小的.
	\end{enumerate}
	\end{Remark}

	\begin{Theorem}
		 设 $ E $ 是赋范空间,  $ F $ 是Banach空间, 则 $ \CB(E, F) $ 是Banach空间.
	\end{Theorem}
	\begin{Proof}
		取 $ (u_{n})_{n\geqslant1} $ 是 $ \CB(E, F) $ 上的 Cauchy列, 即 
		\[
			\forall\varepsilon>0\,\exists n_{0}\in\N\,(n, m\geqslant n_{0}\Rightarrow \norm{u_{m}-u_{n}}<\varepsilon)
		\]
		而 $ \forall x\in E $, 由
		\[
			\norm{u_{m}(x)-u_{n}(x)}=\norm{(u_{m}-u_{n})(x)}\leqslant\norm{u_{m}-u_{n}}\cdot\norm{x}
		\]
		可知 $ (u_{n}(x))_{n\geqslant1} $ 是 $ F $ 中的 Cauchy列, 因 $ F $ 是Banach空间, $ \lim\limits_{n\to \infty} u_{n}(x) $ 存在, 记作 $ u(x) $, 从而定义了算子 $ u $, 下证 $ u\in\CB(E, F) $. 由 
		\[
			\begin{aligned}
				u(\lambda x) & =\lim_{n\to\infty}u_{n}(\lambda x)\\
				& =\lambda\lim_{n\to\infty}u_{n}(x)=\lambda u(x)
			\end{aligned}\qquad
			\text{与}\qquad
			\begin{aligned}
				u(x+y) & =\lim_{n\to\infty}u_{n}(x+y)\\
				& =\lim_{n\to\infty}u_{n}(x)+u_{n}(y)=u(x)+u(y)
			\end{aligned}
		\]
		可知线性性成立, 再由
		\[
			\begin{aligned}
				\norm{u} & =\sup_{\norm{x}=1}\norm{u(x)}=\sup_{\norm{x}=1}\norm{u(x)-u_{n}(x)+u_{n}(x)}\\
				 & \leqslant \sup_{\norm{x}=1}\norm{u(x)-u_{n}(x)}+\sup_{\norm{x}=1}\norm{u_{n}(x)}\\
				& \leqslant \sup_{\norm{x}=1}\limsup_{m\to\infty}\norm{u_{m}-u_{n}}\cdot\norm{x}+\norm{u_{n}}<\infty
			\end{aligned}
		\]
		可知有界性成立. (因为 $ (u_{n})_{n\geqslant1} $ 是 Cauchy列, 从而 $ \limsup\limits_{m\to\infty}\norm{u_{m}-u_{n}}<\infty $)

		还需说明 $ \lim\limits_{n\to\infty}u_{n}=u $. 这由
		\[
			\begin{aligned}
				\norm{u-u_{n}} & =\sup_{\norm{x}=1}\norm{u(x)-u_{n}(x)}\leqslant \sup_{\norm{x}=1}\limsup_{m\to\infty
				}\norm{u_{m}-u_{n}}\norm{x}\\
				& =\limsup_{m\to\infty}\norm{u_{m}-u_{n}}\to 0\,(n\to\infty)
			\end{aligned}
		\]
		可知. 从而 $ \CB(E, F) $ 完备, 即为 Banach空间.\qed
	\end{Proof}

	\begin{Definition}[线性泛函]\label{def:线性泛函}
		 设 $ (E, \norm{\cdot}) $ 是数域 \K 上的赋范空间,  $ \CB(E, \K) $ 是 $ E $ 的\textbf{对偶}, 记作 $ E^{*} $, 则 $ E^{*} $ 是Banach空间, 并称 $ E^{*} $ 中的元素为 $ E $ 的\textbf{连续线性泛函}\index{L!连续线性泛函}.
	\end{Definition}
	\begin{Example}
		给出几个线性泛函相关的例子:
		\begin{enumerate}[(1)]
			\item  对 $ f\in C[0, 1] $, $ x\in [0, 1] $, 定义 $ \delta_{x}(f)=f(x) $, 则 $ \delta_{x} $ 是连续线性泛函; 再对 $ g\in C[0, 1] $ 定义 $ \rho_{g}(f)=\int_{0}^{1}fg\diff x $, 则 $ \rho_{g} $ 是连续线性泛函.
			\item 在 $ \C^{n} $ 上给定 $ y\in\C^{n} $ 定义 
			 \[
				\rho_{y}(x)=\lrangle{x, y}=\sum_{i=1}^{n}x_{i}\baro{y}_{i}.
			\]
			由 Cauchy不等式可知 $ \rho_{y} $ 是连续线性泛函.
			\item $ \forall x, y\in \C^{n} $, 定义 $ \mathbb{M}_{n}(\C) $ 上的算子
			\[
				\omega_{x, y}(A)=\lrangle{Ax, y}.
			\]
			则由
			\[
				\abs{\omega_{x, y}(A)}=\abs{\lrangle{Ax, y}}\leqslant\norm{Ax}\norm{y}\leqslant\norm{A}\norm{x}\norm{y}
			\]
			知 $ \norm{\omega_{x, y}}\leqslant\norm{x}\norm{y}<\infty $, 从而 $ \omega_{x, y} $ 也是连续线性泛函.
			\item 对 $ x\in\C^{n} $ 和 $ A\in\mathbb{M}_{n}(\C) $, 定义 $ x\mapsto \norm{Ax} $, 则它不是连续线性泛函, 甚至不满足线性性.
		\end{enumerate}
	\end{Example}

	\begin{Theorem}
		 设 $ E $ 是有限维线性空间,  $ F $ 是任一赋范空间, 则 $ \mathcal{L}(E, F)=\CB(E, F) $.  
	\end{Theorem}
	\begin{Proof}
		设 $ u\in\CL(E, F) $, 取 $ E $ 的中的一组基 $ e_{1}, e_{2}, \dots e_{n} $, 则
		\[
			\forall x\in E\,\exists[x_{1}, x_{2}, \dots, x_{n}]^{\mathrm T}\,\left(x=\sum_{i=1}^{n}x_{i}e_{i}\right)
		\]
		因为 $ E $ 是有限维的, 故 $ E $ 中任意范数等价, 即 $ \norm{\cdot} $ 是 $ E $ 中的一个范数, 有
		\[
			\begin{aligned}
				\norm{u(x)}=\norm{\sum_{i=1}^{n}x_{i}u(e_{i})} & \leqslant \sum_{i=1}^{n}\abs{x_{i}}\norm{u(e_{i})}\\
				& \leqslant\norm{x}_{\infty}\sum_{i=1}^{n}\norm{u(e_{i})}\leqslant\left( c\sum_{i=1}^{n}\norm{u(e_{i})} \right)\norm{x}.
			\end{aligned}
		\]
		从而 $ u $ 有界, 即 $ \CL(E, F)\subset\CB(E, F) $, 从而 $ \CL(E, F)=\CB(E, F) $. \qed
	\end{Proof}
	
	\begin{Theorem}
		 设 $ E $, $ F $, $ G $都是赋范空间,  $ u\in\CB(E, F) $, $ v\in\CB(F, G) $, 则 $ v\circ u\in\CB(E, G) $, 且有 $ \norm{v\circ u}\leqslant\norm{v}\norm{u} $.
	\end{Theorem}
	\begin{Proof}
		因为
		\[
			\norm{v\circ u}=\sup_{\norm{x}=1}\norm{v(u(x))}\leqslant\norm{v}\sup_{\norm{x}=1}\norm{u(x)}\leqslant\norm{v}\norm{u}<\infty.
		\]
		定理结论可得.\qed
	\end{Proof}

	\begin{Remark}
		在不致混淆时, 有时也将 $ v\circ u $ 记作 $ vu $, 并将复合看作乘法, 因为 $ \CB(E) $ 上有自然的加法与数乘, 赋予乘法后 $ \CB(E) $ 成为一个代数.
	\end{Remark}

	\begin{Theorem}
		设 $ E $, $ F $ 是Banach空间,  $ G $ 是 $ F $ 的稠子空间, 则有界线性映射 $ u: G\to F $ 可以唯一地扩张成有界线性映射 $ \tilde{u}:E\to F $, 且 $ \norm{\tilde{u}}=\norm{u} $.
   \end{Theorem}
   \begin{Proof}
		因为 $ G $ 在 $ E $ 中稠密, 则
		\[
			\forall x\in E\,\exists(x_{n})_{n\geqslant1}\subset G\,(\lim_{n\to\infty}x_{n}=x),
		\]
		且 $ (u(x_{n}))_{n\geqslant1} $ 是 Cauchy列, 由 $ F $ 是Banach空间可知 $ (u(x_{n}))_{n\geqslant1} $ 收敛, 不妨记作 $ y $. 定义
		\[
			\tilde{u}: E\to F\quad x\mapsto y=\lim_{n\to\infty}u(x_{n}).
		\]
		由一致连续映射扩张定理可知 $ \tilde{u} $ well-defined.

		易证 $ \tilde{u} $ 是线性的, 且 $ \tilde{u}|_{G}=u $. 而
		\[
			\norm{\tilde{u}(x)}=\lim_{n\to\infty}\norm{u(x_{n})}\leqslant\norm{u}\lim_{n\to\infty}\norm{x_{n}}\leqslant\norm{u}\norm{x},
		\]
		故 $ \norm{\tilde{u}}\leqslant\norm{u} $, 再由 $ \tilde{u}|_{G}=u $ 知 $ \tilde{u}=\norm{u} $.\qed
		
	\end{Proof}

	\begin{Definition}[同构]\label{def:同构}
		 设 $ E $, $ F $ 是赋范空间, 若 $ u\in\CB(E, F) $ 是双射, 且 $ u^{-1} $ 连续, 则 $ u $ 是 $ E\to F $ 的\textbf{同构映射}. 若 $ E $, $ F $ 间存在同构映射, 则称 $ E $ 与 $ F $ \textbf{同构}.\index{T!同构}
	\end{Definition}

	\begin{Remark}
		设范数 $ \norm{\cdot}_{1} $ 与 $ \norm{\cdot}_{2} $ 等价, 则 $ \id_{E} $是同构映射. 在空间 $ \C^{n} $ 上, 相似变换 $ T $ 是同构映射, 且 $ \norm{T} $ 可以充分大. 一个例子是取
		\[
			T_{t}=\begin{bmatrix}
				1 & t\\
				0 & 1
			\end{bmatrix}
			\qquad
			T_{t}^{-1}=\begin{bmatrix}
				1 & -t \\
				0 & 1
			\end{bmatrix},
		\]
		则有 $ \norm{T_{t}}\geqslant1+\abs{t}/2 $, 且 $ \norm{T_{t}^{-1}}\geqslant 1+\abs{t}/2 $.  
	\end{Remark}

	\begin{Theorem}
		 设 $ E $ 是Banach空间,  $ u\in\CB(E) $ 且 $ \norm{u}<1 $ 则存在 $ v\in\CB(E) $ 使
		 \[
			 (\id_{E}-u)v=v(\id_{E}-u)=\id_{E},
		 \]
		 即 $ \id_{E}-u $ 是一个同构映射, 也即 $ \id_{E}-u $ 在 $ \CB(E) $ 可逆.
	\end{Theorem}
	\begin{Proof}
		由 $ \norm{u}<1 $ 可知 $ \sum\limits_{n\geqslant0}u^n $ 绝对收敛, 由 $ E $ 完备可知 $ \CB
		(E) $ 完备, 则 $ \exists v\in\CB(E) $ 使得 $ v=\sum\limits_{n\geqslant 0}u^n $, 则
		\[
			(\id_E-u)v=(\id_E-u)\sum_{n\geqslant 0}u^n=\lim_{n\to\infty}(\id_E-u^{n+1})=\id_E.
		\]
		同理可证 $ v(\id_E-u)=\id_E $, 则 $ v=(\id_E-u)^{-1} $.\qed
	\end{Proof}
	
	\begin{Theorem}
		设 $ E $是赋范空间, $ F\subset E $ 是闭线性子空间. 则
		\[
			\norm{x+F}_0:=\inf\{ \norm{x+y} : y\in F \},
		\]
		是商空间 $ E/F $ 上的一个范数. 在这一范数下 $ u : x\mapsto x+F $是连续的. 且 $ \norm{u}<1 $. 若 $ E $ 是Banach空间, 则 $ E/F $ 是Banach空间.
	\end{Theorem}
	\begin{Proof}
		先说明 $ \norm{\cdot}_{0} $ well-defined. 取 $ x' $ 是 $ x+F $ 的另一代表元, 往证 $ \norm{x'+F}_{0}=\norm{x+F}_{0} $. 因为
		\[
			\begin{aligned}
				\norm{x'+F}_{0} & =\inf\{ \norm{x'+y}:y\in F \}  = \inf\{ \norm{x+x'-x+y}: y\in F \} \\
				 & =\inf\{ \norm{x+y}: y\in F \}=\norm{x+F}_{0}
			\end{aligned}
		\]
		其中第三个等号是因为 $ x'-x+y\in F $. 则 $ \norm{\cdot}_{0} $ well-defined. 再证 $ \norm{\cdot}_{0} $ 是一个范数. 由
		\[
			\begin{aligned}
				\norm{x+F}_{0}=0 & \Longleftrightarrow d(x, F)=0\\
				&  \Longleftrightarrow x\in F\\
				& \Longleftrightarrow x+F=F
			\end{aligned}
		\]
		知正定性成立. 再由
		\[
			\begin{aligned}
				\norm{\lambda x+F}_{0} & =\inf\{ \norm{\lambda x+y}: y\in F \}=\abs{\lambda}\inf\left\{ \norm{x+\frac{y}{\lambda}}: y\in F \right\}\\
				& =\abs{\lambda}\inf\{ \norm{x+y}: y\in F \}=\abs{\lambda}\norm{x+F}_{0}
			\end{aligned}
		\]
		知齐次性成立, 这里 $ \lambda\neq0 $. 下面证明三角不等式 $ \forall\varepsilon>0 $, 对 $ x_{1}, x_{2} $, 有
		\[
			\exists y_{i}\in F : \norm{x_{i}+y_{i}}\leqslant\norm{x_{i}+F}_{0}+\varepsilon, \qquad i=1, 2
		\]
		则
		\[
			\begin{aligned}
				\norm{x_{1}+x_{2}+F}_{0} & =\inf\{ \norm{x_{1}+x_{2}+y}: y=F \}\\
				& =\inf\{ \norm{x_{1}+y_{1}+x_{2}+y_{2}}: y_{1}, y_{2}\in F \}\\
				& \leqslant \norm{x_{1}+F}_{0}+\norm{x_{2}+F}_{0}+2\varepsilon,
			\end{aligned}
		\]
		令 $ \varepsilon\to 0 $ 即得. 从而 $ \norm{\cdot} $ 是 $ E/F $ 上的范数. 且由
		\[
			 \norm{u(x)}=\norm{x+F}_{0}\leqslant \norm{x+0}=\norm{0}
		\]
		知 $ \norm{u}<1 $.

		若 $ E $ 是Banach空间. 取 $ E/F $ 中绝对收敛的级数 $ \sum\limits_{n\geqslant1}(x_{n}+F) $, 则
		\[
			\exists y_{n}\in F\,(\norm{x_{n}+y_{n}}\leqslant 2^{-n}+\norm{x_{n}+F}_{0})
		\]
		从而由 $ \sum\limits_{n\geqslant}\norm{x_{n}+F}_{0} $ 收敛知 $ \sum\limits_{n\geqslant0}\norm{x_{n}+y_{n}} $ 在 $ E $ 中绝对收敛, 则
		\[
			\exists z\in E\,\bigg( \sum_{n\geqslant0}(x_{n}+y_{n})=z \bigg)
		\]
		而 
		\[
			\begin{aligned}
				\norm{z+F-\sum_{k=1}^{n}x_{k}+F}_{0} & =\inf\left\{ \norm{z-\sum_{k=1}^{n}x_{k}+y}:y\in F \right\}\\
				& \leqslant \norm{z-\sum_{k=1}^{n}(x_{k}+y_{n})}\to 0,\qquad n\to\infty
			\end{aligned}
		\]
		即 $ E/F $ 是Banach空间.\qed
	\end{Proof}
	
\section{内积空间}
	
	\begin{Definition}[内积空间]\index{N!内积}\index{N!内积空间}
	设$ H $是$ \K $上的线性空间, 若映射$ \lrangle{\cdot,\cdot} : H\times H\to\K $满足
	\begin{enumerate}[(1)]
	\item 线性性: $ \forall \lambda_1,\lambda_2\in\K,\,\forall x_1,x_2,y\in H,\ \lrangle{\lambda_1x_1+\lambda_2x_2,y}=\lambda_1\lrangle{x_1,y}+\lambda_2\lrangle{x_2,y} $;
	\item 共轭对称性: $ \lrangle{x,y}=\baro{\lrangle{y,x}} $;
	\item 非负性: $ \forall x\in H $, $ \lrangle{x,x}\geqslant 0 $且$ \lrangle{x,x}=0 $当且仅当$ x=0 $,
	\end{enumerate}
	则称$ \lrangle{\cdot,\cdot} $是一个\textbf{内积}, 并称赋予了内积的空间$ H $是\textbf{内积空间}.
	\end{Definition}
	
	\begin{Example}
	一些常见的内积空间, 在不特殊说明的情况下, 以后提到下面的空间时均默认其上定义的内积是本例中定义的内积:
	\begin{enumerate}[(1)]
	\item 在Euclid空间$ \K^n $上赋以内积$ \lrangle{x,y}=\sum\limits_{i=1}^nx_i\bar{y}_i $. 注意到Euclid范数$ \norm{x}=\sqrt{\lrangle{x,x}} $可被该内积诱导.
	\item 在$ L_2(X) $上赋以内积$ \lrangle{f,g}=\int_Xf\bar{g}\diff\mu $, 且由H\"older不等式可知
	\[
	\abs{\lrangle{f,g}}\leqslant\norm{f}_2\norm{g}_2<\infty,
	\]
	但当$ p\ne 2 $时, $ L_p(X) $不是内积空间.
	\item 在连续函数空间$ C([a,b],\K) $上可以定义内积$ \lrangle{f,g}=\int_a^bf\bar{g}\diff x $.
	\item 在$ n $阶方阵空间$ \mathbb{M}_n(\K) $上可以定义内积$ \lrangle{A,B}=\mathrm{tr(B^\dagger A)} $.
	\end{enumerate}
	\end{Example}
	
	\begin{Theorem}[Cauchy-Schwarz]
	设$ H $是一个内积空间, 则$ \forall x,y\in H $, 有
	\[
	\abs{\lrangle{x,y}}^2\leqslant\lrangle{x,x}\lrangle{y,y}.
	\]
	其中上式等号成立当且仅当$ x $与$ y $线性相关.
	\end{Theorem}
	\begin{Proof}
	$ y=0 $的情形是平凡的, 不妨设$ y\ne 0 $. 那么$ \forall x,y\in H,\ \forall\lambda\in\K $, 有
	\[
	0\leqslant\lrangle{x+\lambda y,x+\lambda y}=\lrangle{x,x}+\bar{\lambda}\lrangle{x,y}+\lambda\baro{\lrangle{x,y}}+\lambda\bar{\lambda}\lrangle{y,y}.
	\]
	取$ \lambda=-\frac{\lrangle{x,y}}{\lrangle{y,y}} $代入, 得
	\[
	\lrangle{x,x}-\frac{\abs{\lrangle{x,y}}^2}{\lrangle{y,y}}-\frac{\abs{\lrangle{x,y}}^2}{\lrangle{y,y}}+\frac{\abs{\lrangle{x,y}}^2}{\abs{\lrangle{y,y}}^2}\lrangle{y,y}\geqslant 0,
	\]
	整理可得$ \abs{\lrangle{x,y}}^2\leqslant\lrangle{x,x}\lrangle{y,y} $.
	
	由证明过程可知等号成立当且仅当$ \lrangle{x+\lambda y,x+\lambda y}=0 $, 也即$ x=-\lambda y $, 此时$ x,y $是线性相关的.\qed
	\end{Proof}
	
	\begin{Corollary}\label{col:内积诱导范数}
	设$ H $是内积空间, 则$ \norm{x}=\sqrt{\lrangle{x,x}} $是范数.
	\end{Corollary}
	\begin{Proof}
	由内积的定义可知正定性与齐次性都成立, 只需验证三角不等式成立即可. 由
	\[
		\begin{aligned}
		\norm{x+y}^2=\lrangle{x+y,x+y}&=\lrangle{x,x}+\lrangle{x,y}+\baro{\lrangle{x,y}}+\lrangle{y,y}\\
		&\leqslant\norm{x}^2+2\Re\lrangle{x,y}+\norm{y}^2\leqslant\norm{x}^2+2\norm{x}\norm y+\norm y^2=(\norm x+\norm y)^2.
		\end{aligned}
	\]
	从而$ \norm{x+y}\leqslant\norm x+\norm y $.\qed
	\end{Proof}
	
	\begin{Definition}[Hilbert空间]\index{H!Hilbert空间}
	设$ H $是一个内积空间, 称推论\,\ref{col:内积诱导范数}\,中的范数$ \norm{\cdot} $是由内积$ \lrangle{\cdot,\cdot} $诱导出的范数, 从而$ (H,\norm{\cdot}) $是赋范空间. 若它是一个Banach空间, 则称$ H $是\textbf{Hilbert空间}.
	\end{Definition}
	
	由Cauchy-Schwarz不等式可以导出内积相对于自身诱导的范数是连续的. 同时, 类似于赋范空间的结论, 内积空间$ H $的完备化$ \tilde{H} $是Hilbert空间.
	
	\begin{Example}
	$ L_2(X) $是Hilbert空间, $ \mathbb{M}_n(\K) $也是Hilbert空间. 但$ C[0,1] $是内积空间而不是Hilbert空间, 其完备化是$ L_2[0,1] $.
	\end{Example}
	
	\begin{Proposition}[极化恒等式]
	设$ H $是$ \K $上的内积空间, 则对$ \forall x,y\in H $, 有
	\[
	\lrangle{x,y}=\frac{1}{4}\sum_{k=0}^3\imag^k\norm{x+\imag^ky}^2.
	\]
	特别地, 在实的情形时上式退化为
	\[
	\lrangle{x,y}=\frac{1}{2}(\norm{x+y}^2-\norm{x}^2-\norm{y}^2).
	\]
	\end{Proposition}
	
	\begin{Proposition}[平行四边形公式]
	设$ H $是$ \K $上的内积空间, 则对$ \forall x,y\in H $, 有
	\[
	\norm{x+y}^2+\norm{x-y}^2=2(\norm{x}^2+\norm{y}^2).
	\]
	\end{Proposition}
	
	上面的两个命题, 即极化恒等式和平行四边形公式, 都可以将范数展开成内积之后直接证明.
	
	\begin{Corollary}
	对$ \forall f,g\in L_2(X) $, 有
	\[
	\norm{f+g}_2^2+\norm{f-g}_2^2=2(\norm{f}_2^2+\norm g_2^2).
	\]
	进一步, 对$ 2\leqslant p<\infty $, 有
	\[
	\norm{f+g}_p^p+\norm{f-g}_p^p\leqslant 2^{p-1}(\norm{f}_p^p+\norm{g}_p^p),
	\]
	上式称为\textbf{Clarkson不等式}, 其证明在正文中不再叙述.
	\end{Corollary}
	
	\begin{Theorem}
	设$ H $是赋范空间, 若范数$ \norm{\cdot} $满足平行四边形公式, 则它可被$ H $上的一个内积诱导出来.
	\end{Theorem}

	\begin{Proof}
		构造二元映射:
		\[
			\lrangle{\cdot, \cdot}: H\times H\to \C, \qquad(x, y)\mapsto\frac{1}{4}\sum_{k=0}^3\imag^k\norm{x+\imag^ky}^2,
		\]
		注意到
		\[
			\lrangle{x, x}=\frac{1}{4}(4\norm{x}^{2}+2\imag\norm{x}^{2}-2\imag\norm{x}^{2})=\norm{x}^{2}\geqslant0,
		\]
		且上式取等当且仅当 $ \norm{x}^{2}=0 $, 即 $ x=0 $, 从而正定性与非负性成立, 再由
		\[
			\begin{aligned}
				\lrangle{y, x} & =\frac{1}{4}(\norm{x+y}^{2}-\norm{x-y}^{2}+\imag\norm{x-\imag y}^{2}-\imag\norm{x+\imag y}^{2})\\
				& = \frac{1}{4}\baro{(\norm{x+y}^{2}-\norm{x-y}^{2}-\imag\norm{x-\imag y}^{2}+\imag\norm{x+\imag y}^{2})} =\baro{\lrangle{x, y}}
			\end{aligned}
		\]
		可知共轭对称性成立, 只需证明线性性.

		为此, 我们先证明 $ \lrangle{2x, y}=2\lrangle{x, y} $, 由平行四边形公式, 有
		\begin{equation}\tag{1}
			\norm{2x+y}^{2}+\norm{y}^{2}=2(\norm{x}^{2}+\norm{x+y}^{2}),\qquad x, y\in H\label{eq:1}
		\end{equation}
		因为上式对 $ \forall x, y\in H $ 成立, 将 $ y $ 替换成 $ \imag y, \imag^{2} y, \imag^{3} y $ 得
		\begin{align}
			\norm{2x+\imag y}^{2}+\norm{y}^{2}& =2(\norm{x}^{2}+\norm{x+\imag y}^{2})\tag{2}\label{eq:i}\\
			\norm{2x-y}^{2}+\norm{y}^{2} & =2(\norm{x}^{2}+\norm{x-y}^{2})\tag{3}\label{eq:i2}\\
			\norm{2x-\imag y}^{2}+\norm{y}^{2} & =2(\norm{x}^{2}+\norm{x-\imag y}^{2})\label{eq:i3}\tag{4}
		\end{align}
		则 $ \eqref{eq:1}+\imag\cdot\eqref{eq:i}+\imag^{2}\cdot\eqref{eq:i2}+\imag^{3}\cdot\eqref{eq:i3} $ 即可得 $ \lrangle{2x, y}=2\lrangle{x, y} $, 再由
		\[
			\lrangle{2x, y}=2\lrangle{x, y}=2\baro{\lrangle{y, x}}=\baro{\lrangle{2y, x}}=\lrangle{x, 2y}
		\]
		可知 $ \lrangle{x, 2y}=2\lrangle{x, y} $. 再说明 $ \lrangle{x_{1}+x_{2}, y}=\lrangle{x_{1}, y}+\lrangle{x_{2}, y} $ 成立. 由平行四边形公式, 有
		\begin{equation}\tag{1'}
			\norm{x_{1}+x_{2}, y}^{2}+\norm{x_{1}-x_{2}}^{2}=2\left( \norm{x_{1}+\frac{y}{2}}^{2}+\norm{x_{1}+\frac{y}{2}}^{2} \right)
		\end{equation}
		类似地, 将 $ y $ 替换为 $ \imag y $, $ \imag^{2}y $, $ \imag^{3}y $ 可得 $ (2'), (3'), (4') $, 即有
		\[
			\lrangle{x_{1}+x_{2}, y}=2\lrangle{x_{1}, \frac{y}{2}}+2\lrangle{x_{2}, \frac{y}{2}}=\lrangle{x_{1}, y}+\lrangle{x_{2}, y}.
		\]

		下证对 $ \forall\lambda\in\C $
		\begin{equation}\label{eq:内积数乘}
			\lrangle{\lambda x, y}=\lambda\lrangle{x, y}
		\end{equation}
		成立. 由 $ \lambda=2 $ 的情形可知\,\eqref{eq:内积数乘}\,对任意 $ n\in\N $ 成立, 再由
		\[
			\lrangle{x-x, y}=\lrangle{x, y}+\lrangle{-x, y}=0
		\]
		可知 $ \lrangle{-x, y}=-\lrangle{x, y} $, 即\,\eqref{eq:内积数乘}\,对任意 $ \lambda\in\Z $ 成立. 再由
		\[
			\lrangle{x, y}=n\lrangle{\frac{1}{n}x, y}
		\]
		可知 $ \frac{1}{n}\lrangle{x, y}=\lrangle{\frac{1}{n}x, y} $, 即\,\eqref{eq:内积数乘}\,对任意 $ \lambda\in\Q $ 成立. 由范数的连续性可知对任意 $ \lambda\in\R $ 成立. 再由
		\[
			\lrangle{\imag x, y}=\frac{1}{4}\sum_{k=0}^{3}\imag^{k}\norm{\imag x+\imag^{k}y}^{2}=\frac{\imag}{4}\sum_{k=0}^{3}\imag^{k}\norm{\imag x+\imag^{k}y}^{2}=\imag\lrangle{x, y}
		\]
		知\,\eqref{eq:内积数乘}\,对任意 $ \lambda\in\C $ 成立.\qed
	\end{Proof}

	\section{投影算子}
	\subsection{闭凸集上的投影}
	
	\begin{Definition}[凸集]\label{def:凸集}
		设 $ H $ 是线性空间, $ C\subset H $. 若对 $ \forall x, y\in C $, $ 0\leqslant\lambda\leqslant1 $, 都有
		\[
			\lambda x+(1-\lambda)y\in C,
		\]
		则称 $ C $ 是一个\textbf{凸集}\index{T!凸集}.
	\end{Definition}
	例如 $ \K^{n} $ 中的三角形 $ T $, 圆盘 $ D $ 和线性空间 $ E $ 的线性子空间都是凸集.
	
	\begin{Proposition}
		设 $ (C_{i})_{i\in\alpha} $ 是 $ H $ 上的一族凸集, 则 $ \bigcap_{i\in\alpha}C_{i} $ 也是凸集.
	\end{Proposition}

	\begin{Definition}[凸包]\label{def:凸包}\index{T!凸包}
		 设 $ H $ 是一个线性空间, $ A\subset H $. 称包含 $ A $ 的最小凸集是 $ A $ 的\textbf{凸包}, 记作 $ \conv(A) $. 或等价地, 记包含 $ A $ 的凸集全体为 $ \mathcal{C} $, 则 $ \conv(A)=\bigcap \mathcal{C} $. 
	\end{Definition}

	\begin{Proposition}
		$ \conv(A)=\left\{ \sum\limits_{i=1}^{n}\lambda_{i}x_{i}:\sum\limits_{i=1}^{n}\lambda_{i}=1, \lambda_{i}>0, x_{i}\in A, n\in \N \right\} $. 
	\end{Proposition}
	
	\begin{Proof}
		记右侧集合为 $ B $, 因为 $ A\subset B $ 且 $ B $ 是凸集, 由凸包定义有 $ \conv(A)\subset B $. 再说明反向不等式成立. 因为 $ \sum\limits_{i=1}^{n}\lambda_{i}x_{i}\in C $, 其中 $ C\supset A $ 且 $ C $ 是凸集, 故有 $ \sum\limits_{i=1}^{n}\lambda_{i}x_{i}\in\conv(A) $. 从而有 $ B\subset\conv(A) $. 即 $ \conv(A)=B $.\qed
	\end{Proof}

	\begin{Theorem}[闭凸集投影定理]
		设 $ H $ 是 Hilbert空间, $ C\subset H $ 是非空的闭凸子集, 则有:
		\begin{enumerate}[(1)]
			\item $ \forall x\in H\,\exists!y\in C\,(\norm{x-y}=d(x, C)) $, 并称 $ y $ 是 $ x $ 在$ C $ 上的\textbf{投影}, 记作 $ P_{C}(x) $;
			\item 对$ \forall y\in H $, $ y=P_{C}(x) $ 的充分必要条件是 $ \Re\lrangle{x-y, z-y}\leqslant0 $;
			\item 映射 $ x\mapsto P_{C}(x) $ 是常数为 $ 1 $ 的 Lipschitz映射, 即 $ \forall x, x'\in H $, 有
			\[
				\norm{P_{C}(x)-P_{C}(x')}\leqslant \norm{x-x'};
			\]
			\item 投影算子是幂等的, 即 $ P^{2}_{C}=P_{C} $, 且 $ P_{C}(H)=C $. 
		\end{enumerate}
	\end{Theorem}
	
	\begin{Proof}
		(1) 令 $ d=d(x, C)=\inf\limits_{z\in C}\norm{x-z} $, 由定义知
		\[
			\forall n\in\N\,\exists y_{n}\in C\,\left(d\leqslant\norm{x-y_{n}}\leqslant d+\frac{1}{n}\right),
		\]
		从而得到一列序列 $ (y_{n})_{n\geqslant1} $, 那么由
		\[
			\begin{aligned}
				\norm{y_{n}-y_{m}}^{2} & =2(\norm{x-y_{n}}^{2}+\norm{x-y_{m}}^{2})-\norm{2x-(y_{m}+y_{n})}^{2}\\
				& \leqslant 2\left( \left( d+\frac{1}{n} \right)^{2}+\left( d+\frac{1}{m} \right)^{2} \right)-4d^{2}\\
				& =\frac{2d}{n}+\frac{2d}{m}+\frac{1}{n^{2}}+\frac{1}{m^{2}}\to 0,\qquad n,m\to \infty
			\end{aligned}
		\]
		其中第一个不等号是因为
		\[
			\norm{2x-(y_{m}+y_{n})}^{2}=4\norm{x-\frac{y_{m}+y_{n}}{2}}^{2}\leqslant4d^{2}
		\]
		从而 $ (y_{n})_{n\geqslant1} $ 是 Cauchy列, 则 $ \exists y\in H $ 使得 $ \lim\limits_{n\to\infty}y_{n}=y $, 因为 $ C $ 是闭集, 则 $ y\in C $ 且 $ \norm{x-y}=d $.

		再证唯一性. 设 $ y'\in C $ 使得 $ \norm{x-y'}=d $, 则
		\[
			\begin{aligned}
				0\leqslant\norm{y-y'}^{2} & =2(\norm{x+y}^{2}+\norm{x-y}^{2})-\norm{2x-(y+y')}^{2}\\
				 & \leqslant 2(d^{2}+d^{2})-4d^{2}=0.
			\end{aligned}
		\]
		即 $ \norm{y-y'}=0 $, 也即 $ y=y' $.

		(2) \textsl{必要性}. 设 $ y=P_{C}(x) $. 则 $ \forall z\in C $, 有
		\[
			\begin{aligned}
				\norm{x-y}^{2}\leqslant\norm{x-z}^{2} & = \norm{(x-y)-(z-y)}^{2}
				 & =\norm{x-y}^{2}-2\Re\lrangle{x-y, z-u}+\norm{z-y}^{2},
			\end{aligned}
		\]
		即 $ 2\Re\lrangle{x-y, z-y}\leqslant\norm{z-y}^{2} $. 令 $ z'=\lambda y+(1-\lambda)z\in C $, 将上式中的 $ z $ 替换为 $ z' $, 有
		\[
			2\Re\lrangle{x-y, (1-\lambda)(z-y)}\leqslant\norm{(1-\lambda)(z-y)}^{2},
		\]
		即 $ 2(1-\lambda)\Re\lrangle{x-y, z-y}\leqslant(1-\lambda)^2\norm{z-y}^{2} $, 令 $ \lambda\to 1 $ 可得 $ \Re\lrangle{x-y, z-y}\leqslant0 $.
		
		\textsl{充分性}. 由 $ \forall z\in C\,(\Re\lrangle{x-y, z-y}\leqslant0) $, 有
		\[
			\begin{aligned}
				\norm{x-z}^{2} & = \norm{(x-y)-(z-y)}^{2}\\
				& =\norm{x-y}^{2}-2\Re\lrangle{x-y, z-y}+\norm{z-y}^{2}\geqslant\norm{x-y}^{2}.
			\end{aligned}
		\]
		从而 $ \norm{x-y}\leqslant\norm{z-y}, \forall z\in C $, 即 $ y=P_{C}(x) $.

		(3) $ \forall x, x'\in H $, 取 $ y=P_{C}(x), y'=P_{C}(x') $, 则
		\[
			\norm{y-y'}^{2}=\lrangle{y-y', y-y'}=\lrangle{y-x, y-y'}+\lrangle{x-x', y-y'}+\lrangle{x'-y', y-y'},
		\]
		注意到左侧为实数, 两侧取实部有
		\[
			\begin{aligned}
				\norm{y-y'}^{2} & =\Re\lrangle{y-x, y-y'}+\Re\lrangle{x-x', y-y'}+\Re\lrangle{x'-y', y-y'}\\
				& \leqslant \Re\lrangle{x-x', y-y'}\leqslant \norm{x-x'}\norm{y-y'},
			\end{aligned}
		\]
		其中第一个不等号因为\,(2)\,的必要性, 即有 $ \norm{y-y'}\leqslant\norm{x-x'} $, 即 $ \norm{P_{C}(x)-P_{C}(x')}\leqslant \norm{x-x'} $.
		
		(4) $ \forall x\in H, P_{C}(x)\in C $, 故 $ P_{C}(P_{C}(x))=P_{C}(x) $, 从而 $ P_{C}^{2}=P_{C} $. 且由上可知 $ P_{C}(C)=C $, 所以 $ P_{C}(H)=C $.\qed
	\end{Proof}

	\begin{Remark}
		这里对上述定理进行一些说明
		\begin{enumerate}[(1)]
			\item $ P_{C} $ 不是线性算子(因为像空间 $ C $ 未必是线性空间), 但若 $ C $ 是 $ H $ 的闭线性子空间时, $ P_{C} $ 是线性算子;
			\item 证明中实际只使用了 $ C $ 的完备性. 因为若 $ H $ 是任意的内积空间, 只需 $ C $ 是 $ H $ 中的完备凸集即可.
		\end{enumerate}
	\end{Remark}

	\subsection{正交性\ \ 投影线性算子}

	\begin{Definition}[正交, 正交补]\label{def:正交, 正交补}\index{Z!正交}
		 设 $ H $ 是内积空间,  若 $ x, y\in H $ 使 $ \lrangle{x, y}=0 $, 则称 $ x $ 与 $ y $ \textbf{正交}, 记作 $ x\bot y $. 对任意的 $ A\subset H $, 称:
		 \[
			A^{\bot}=\{ x\in H: x\bot y, \forall y\in A \} 
		 \]
		 为 $ A $ 在 $ H $ 中的\textbf{正交补}.
	\end{Definition}

	\begin{Remark}
		有关正交性与正交补的注记:
		\begin{enumerate}[(1)]
			\item 对 $ x\ne0, y\ne 0 $, 可定义向量的夹角
			\[
				\cos\theta=\frac{\Re\lrangle{x, y}}{\norm{x}\norm{y}},\qquad \theta\in[0, \pi]
			\]
			则有\textbf{余弦定理}
			\[
				\norm{x+y}^{2}=\norm{x}^{2}+\norm{y}^{2}+2\norm{x}\norm{y}\cos\theta,
			\]
			特别地, 若 $ x\bot y $, 上式退化为\textbf{勾股定理}: $ \norm{x+y}^{2}=\norm{x}^{2}+\norm{y}^{2} $. 但反之不成立, 由 $ \norm{x+y}^{2}=\norm{x}^{2}+\norm{y}^{2} $ 只能推出 $ \Re\lrangle{x, y}= 0 $.
			\item 由内积的连续性, 知 $ A^{\bot} $ 是 $ H $ 的闭线性子空间, 且
			\[
				A^{\bot}=\baro{A}^{\bot}=(\Span A)^{\bot}=\baro{\Span A}^{\bot}.
			\]
		\end{enumerate}
	\end{Remark}
